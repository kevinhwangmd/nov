<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Novelatta</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica', 'Arial', sans-serif;
            background-color: #f3f4f6;
        }

        /* Header Styles */
        .header {
            background-color: #666699;
            color: white;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 16px;
        }

        .header-title {
            font-size: 24px;
            font-weight: bold;
        }

        /* Header Button Overrides */
        .header .btn-primary,
        .header .btn-secondary {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .header .btn-primary:hover,
        .header .btn-secondary:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        .header .btn-secondary[title="About"] {
            background: rgba(255, 255, 255, 0.2);
        }

        .header .btn-secondary[title="About"]:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .header .btn-gray {
            background-color: #e5e7eb;
            color: #374151;
        }

        .header .btn-gray:hover {
            background-color: #d1d5db;
        }

        /* Main Tabs */
        .main-tabs {
            background: white;
            border-bottom: 2px solid #e5e7eb;
        }

        .main-tabs-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 16px;
            display: flex;
            gap: 8px;
        }

        .main-tab {
            padding: 16px 24px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 15px;
            font-weight: 600;
            color: #6b7280;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            margin-bottom: -2px;
        }

        .main-tab:hover {
            color: #4f46e5;
            background-color: #f9fafb;
        }

        .main-tab.active {
            color: #4f46e5;
            border-bottom-color: #4f46e5;
        }

        /* Sub-header for view controls */
        .sub-header {
            background: white;
            border-bottom: 1px solid #e5e7eb;
        }

        .sub-header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 12px 16px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            gap: 12px;
        }

        .tab-buttons {
            display: flex;
            gap: 8px;
        }

        .tab-btn {
            padding: 8px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .tab-btn.active {
            background-color: #4f46e5;
            color: white;
        }

        .tab-btn.inactive {
            background-color: #e5e7eb;
            color: #374151;
        }

        .tab-btn.inactive:hover {
            background-color: #d1d5db;
        }

        /* Button Styles */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
        }

        .btn-primary {
            background-color: #4f46e5;
            color: white;
        }

        .btn-primary:hover {
            background-color: #4338ca;
        }

        .btn-secondary {
            background-color: #5b21b6;
            color: white;
        }

        .btn-secondary:hover {
            background-color: #6d28d9;
        }

        .btn-danger {
            background-color: #dc2626;
            color: white;
        }

        .btn-danger:hover {
            background-color: #b91c1c;
        }

        .btn-gray {
            background-color: #e5e7eb;
            color: #374151;
        }

        .btn-gray:hover {
            background-color: #d1d5db;
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 13px;
        }

        /* Main Content */
        .main-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 24px 16px;
        }

        /* Welcome/Empty States */
        .welcome-section {
            text-align: center;
            padding: 64px 16px;
        }

        .welcome-title {
            font-size: 30px;
            font-weight: bold;
            color: #374151;
            margin-bottom: 16px;
        }

        .welcome-subtitle {
            font-size: 16px;
            color: #6b7280;
            margin-bottom: 32px;
        }

        .empty-state {
            text-align: center;
            padding: 64px 16px;
        }

        .empty-title {
            font-size: 24px;
            font-weight: bold;
            color: #374151;
            margin-bottom: 12px;
        }

        .empty-subtitle {
            font-size: 16px;
            color: #6b7280;
            margin-bottom: 24px;
        }

        /* Card Grid */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
        }

        /* Character/Location Card */
        .character-card {
            background-color: white;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            padding: 16px;
            transition: all 0.2s;
            cursor: move;
        }

        .character-card:hover {
            border-color: #4f46e5;
            box-shadow: 0 4px 6px rgba(79, 70, 229, 0.1);
        }

        .character-card.expanded {
            border-color: #4f46e5;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.2);
        }

        .character-card.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }

        .card-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 12px;
        }

        .card-title-section {
            flex: 1;
        }

        .card-name {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 4px;
        }

        .role-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 500;
        }

        .role-protagonist {
            background-color: #dbeafe;
            color: #1e40af;
        }

        .role-antagonist {
            background-color: #fee2e2;
            color: #991b1b;
        }

        .role-supporting {
            background-color: #fef3c7;
            color: #92400e;
        }

        .role-minor {
            background-color: #f3f4f6;
            color: #374151;
        }

        .card-actions {
            display: flex;
            gap: 4px;
        }

        .icon-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            color: #6b7280;
            transition: color 0.2s;
        }

        .icon-btn:hover {
            color: #4f46e5;
        }

        .icon-btn.delete:hover {
            color: #dc2626;
        }

        .card-preview {
            font-size: 14px;
            color: #4b5563;
            line-height: 1.6;
            margin-top: 8px;
        }

        .preview-text {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .card-details {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #e5e7eb;
        }

        .detail-section {
            margin-bottom: 16px;
        }

        .detail-section:last-child {
            margin-bottom: 0;
        }

        .detail-label {
            font-size: 12px;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 6px;
        }

        .detail-content {
            font-size: 14px;
            color: #374151;
            line-height: 1.6;
        }

        /* Controls Bar */
        .controls-bar {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 200px;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
        }

        .search-input:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        /* Modal */
        .modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal {
            background-color: white;
            border-radius: 8px;
            padding: 24px;
            width: 600px;
            max-width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 25px rgba(0, 0, 0, 0.15);
        }

        .modal-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 20px;
            font-weight: bold;
            color: #111827;
        }

        .close-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 24px;
            color: #6b7280;
            padding: 0;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-btn:hover {
            color: #374151;
        }

        .modal-buttons {
            display: flex;
            gap: 8px;
            margin-top: 20px;
            justify-content: flex-end;
        }

        /* Form Styles */
        input[type="text"],
        textarea,
        select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
        }

        input[type="text"]:focus,
        textarea:focus,
        select:focus {
            outline: none;
            border-color: #4f46e5;
            box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        .form-group {
            margin-bottom: 12px;
        }

        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            color: #374151;
            margin-bottom: 4px;
        }

        /* List View */
        .list-view {
            background-color: white;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            overflow: hidden;
        }

        .list-header {
            display: grid;
            gap: 12px;
            padding: 12px 16px;
            background-color: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
            font-size: 13px;
            font-weight: 600;
            color: #6b7280;
        }

        .list-row {
            display: grid;
            gap: 12px;
            padding: 12px 16px;
            border-bottom: 1px solid #e5e7eb;
            cursor: move;
            transition: background-color 0.2s, opacity 0.2s;
        }

        .list-row:hover {
            background-color: #f9fafb;
        }

        .list-row:last-child {
            border-bottom: none;
        }

        .list-row.dragging-row {
            opacity: 0.5;
            cursor: grabbing;
        }

        .list-cell {
            font-size: 14px;
            color: #374151;
            display: flex;
            align-items: center;
        }

        .list-actions {
            display: flex;
            gap: 8px;
            justify-content: flex-end;
        }

        /* Footer */
        .footer {
            max-width: 1400px;
            margin: 40px auto 0;
            padding: 24px 16px;
            text-align: center;
            font-size: 13px;
            color: #6b7280;
            border-top: 1px solid #e5e7eb;
        }

        /* Utility */
        .hidden {
            display: none;
        }

        .flex-1 {
            flex: 1;
        }

        /* ===== SCENE-SPECIFIC STYLES ===== */
        
        /* Acts Grid Layout */
        .acts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        @media (min-width: 1200px) {
            .acts-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .act-column {
            display: flex;
            flex-direction: column;
        }

        .act-header {
            background: linear-gradient(135deg, #4f46e5 0%, #6366f1 100%);
            color: white;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 4px rgba(79, 70, 229, 0.2);
        }

        .act-title {
            font-size: 18px;
            font-weight: bold;
            letter-spacing: 0.5px;
        }

        .scenes-container {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        /* Scene Card */
        .scene-card {
            background-color: white;
            border: 2px solid;
            border-radius: 8px;
            padding: 12px;
            cursor: pointer;
            transition: all 0.2s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
        }

        .scene-card:hover {
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.12);
            transform: translateY(-1px);
        }

        .scene-card.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }

        .scene-card.editing {
            border-width: 3px;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
            min-width: 400px;
        }

        .scene-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .scene-title-section {
            flex: 1;
        }

        .scene-title {
            font-weight: 600;
            font-size: 15px;
            color: #111827;
            margin-bottom: 4px;
        }

        .scene-type {
            font-size: 12px;
            color: #6b7280;
        }

        .scene-actions {
            display: flex;
            gap: 4px;
        }

        .scene-details {
            font-size: 13px;
            color: #374151;
            line-height: 1.5;
        }

        .scene-detail-row {
            margin-bottom: 6px;
        }

        .scene-detail-label {
            font-weight: 600;
            color: #6b7280;
            margin-right: 4px;
        }

        /* Chapter Styles */
        .chapter-container {
            margin-bottom: 20px;
        }

        .chapter-scenes {
            margin-left: 16px;
            padding-left: 12px;
            border-left: 2px solid #e5e7eb;
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 12px;
        }

        .chapter-header {
            background-color: #f3f4f6;
            padding: 10px 14px;
            border-radius: 8px;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-left: 4px solid #6366f1;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .chapter-header:hover {
            background-color: #e5e7eb;
        }

        .chapter-title {
            font-weight: 600;
            font-size: 14px;
            color: #374151;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .chapter-arrow-btn {
            background: none;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            cursor: pointer;
            padding: 2px 8px;
            font-size: 14px;
            color: #6b7280;
            transition: all 0.2s;
        }

        .chapter-arrow-btn:hover:not(:disabled) {
            background-color: #f3f4f6;
            color: #374151;
        }

        .chapter-arrow-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        /* Scene Color Classes */
        .color-gray { background-color: #f3f4f6; border-color: #d1d5db; }
        .color-red { background-color: #fef2f2; border-color: #fca5a5; }
        .color-orange { background-color: #fff7ed; border-color: #fdba74; }
        .color-yellow { background-color: #fefce8; border-color: #fde047; }
        .color-green { background-color: #f0fdf4; border-color: #86efac; }
        .color-blue { background-color: #eff6ff; border-color: #93c5fd; }
        .color-purple { background-color: #faf5ff; border-color: #d8b4fe; }
        .color-pink { background-color: #fdf2f8; border-color: #f9a8d4; }

        /* Scenes Table */
        .scenes-table-container {
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .scenes-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        .scenes-table th {
            background-color: #f9fafb;
            padding: 12px 8px;
            text-align: left;
            font-weight: 600;
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            user-select: none;
            white-space: nowrap;
        }

        .scenes-table td {
            padding: 12px 8px;
            border-bottom: 1px solid #e5e7eb;
            color: #374151;
            max-width: 200px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .scenes-table tr:hover {
            background-color: #f9fafb;
        }

        .scene-row-expanded {
            background-color: #f3f4f6 !important;
        }

        .expanded-scene-content {
            padding: 16px;
            background-color: #fafafa;
            border-left: 4px solid #4f46e5;
        }

        .expanded-field {
            margin-bottom: 12px;
        }

        .expanded-field-label {
            font-weight: 600;
            font-size: 12px;
            color: #6b7280;
            margin-bottom: 4px;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .expanded-field-value {
            font-size: 13px;
            color: #374151;
            line-height: 1.5;
        }

        .color-dot {
            display: inline-block;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            border: 2px solid;
        }

        .chapter-number {
            font-size: 12px;
            color: #6b7280;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const COLORS = [
            { name: 'Gray', className: 'color-gray' },
            { name: 'Red', className: 'color-red' },
            { name: 'Orange', className: 'color-orange' },
            { name: 'Yellow', className: 'color-yellow' },
            { name: 'Green', className: 'color-green' },
            { name: 'Blue', className: 'color-blue' },
            { name: 'Purple', className: 'color-purple' },
            { name: 'Pink', className: 'color-pink' }
        ];

        const CHARACTER_TYPES = [
            { value: 'protagonist', label: 'Protagonist', className: 'role-protagonist' },
            { value: 'antagonist', label: 'Antagonist', className: 'role-antagonist' },
            { value: 'supporting', label: 'Supporting', className: 'role-supporting' },
            { value: 'minor', label: 'Minor', className: 'role-minor' }
        ];

        const LOCATION_TYPES = [
            { value: 'city', label: 'City' },
            { value: 'building', label: 'Building' },
            { value: 'room', label: 'Room' },
            { value: 'landscape', label: 'Landscape' },
            { value: 'other', label: 'Other' }
        ];

        function App() {
            const lastModified = "Nov 28, 2025";
            const [activeMainTab, setActiveMainTab] = useState('scenes'); // 'scenes', 'characters', 'locations'
            const [viewMode, setViewMode] = useState('card'); // 'card' or 'list' for characters/locations
            const [scenesViewMode, setScenesViewMode] = useState('card'); // 'card' or 'list' for scenes
            const [scenesSearchQuery, setScenesSearchQuery] = useState('');
            const [projects, setProjects] = useState([]);
            const [currentProject, setCurrentProject] = useState(null);
            
            // Scene/Chapter state
            const [scenes, setScenes] = useState([]);
            const [chapters, setChapters] = useState([]);
            
            // Character/Location state
            const [characters, setCharacters] = useState([]);
            const [locations, setLocations] = useState([]);
            const [notes, setNotes] = useState([]);
            
            // UI state
            const [searchQuery, setSearchQuery] = useState('');
            const [expandedCard, setExpandedCard] = useState(null);
            const [editingCard, setEditingCard] = useState(null);
            const [editingScene, setEditingScene] = useState(null);
            const [editingChapter, setEditingChapter] = useState(null);
            const [showModal, setShowModal] = useState(false);
            const [showSceneModal, setShowSceneModal] = useState(false);
            const [showNewProject, setShowNewProject] = useState(false);
            const [showSaveAs, setShowSaveAs] = useState(false);
            const [showAbout, setShowAbout] = useState(false);
            const [aboutTab, setAboutTab] = useState('quickstart');
            const [showExportMenu, setShowExportMenu] = useState(false);
            const [showFileMenu, setShowFileMenu] = useState(false);
            const [showFirstSaveNotice, setShowFirstSaveNotice] = useState(false);
            const [newProjectName, setNewProjectName] = useState('');
            const [saveFileName, setSaveFileName] = useState('');
            const [unsavedChanges, setUnsavedChanges] = useState(false);
            const [saveSuccessMessage, setSaveSuccessMessage] = useState(false);
            
            // Drag state
            const [draggedCharacter, setDraggedCharacter] = useState(null);
            const [draggedLocation, setDraggedLocation] = useState(null);
            const [draggedScene, setDraggedScene] = useState(null);
            const [dragOverChapter, setDragOverChapter] = useState(null);
            const [expandedSceneRow, setExpandedSceneRow] = useState(null);
            
            const fileInputRef = useRef(null);

            // Filter scenes by search query
            const getFilteredScenes = () => {
                if (!scenesSearchQuery) return scenes;
                
                const query = scenesSearchQuery.toLowerCase();
                return scenes.filter(scene => {
                    const chapterName = scene.chapterId 
                        ? chapters.find(c => c.id === scene.chapterId)?.name || ''
                        : '';
                    
                    return (
                        (scene.title && scene.title.toLowerCase().includes(query)) ||
                        (scene.objective && scene.objective.toLowerCase().includes(query)) ||
                        (scene.obstacle && scene.obstacle.toLowerCase().includes(query)) ||
                        (scene.outcome && scene.outcome.toLowerCase().includes(query)) ||
                        (scene.emotion && scene.emotion.toLowerCase().includes(query)) ||
                        (scene.deliberation && scene.deliberation.toLowerCase().includes(query)) ||
                        (scene.decision && scene.decision.toLowerCase().includes(query)) ||
                        (scene.notes && scene.notes.toLowerCase().includes(query)) ||
                        (chapterName && chapterName.toLowerCase().includes(query))
                    );
                });
            };

            // Track unsaved changes
            useEffect(() => {
                if (currentProject && (scenes.length > 0 || characters.length > 0 || locations.length > 0 || notes.length > 0)) {
                    setUnsavedChanges(true);
                }
            }, [scenes, characters, locations, notes]);

            // Close export menu when clicking outside
            useEffect(() => {
                const handleClickOutside = (e) => {
                    if (showExportMenu && !e.target.closest('.btn')) {
                        setShowExportMenu(false);
                    }
                };
                
                document.addEventListener('click', handleClickOutside);
                return () => document.removeEventListener('click', handleClickOutside);
            }, [showExportMenu]);

            // Close file menu when clicking outside
            useEffect(() => {
                const handleClickOutside = (e) => {
                    if (showFileMenu && !e.target.closest('.file-menu-container')) {
                        setShowFileMenu(false);
                    }
                };
                
                document.addEventListener('click', handleClickOutside);
                return () => document.removeEventListener('click', handleClickOutside);
            }, [showFileMenu]);

            // Keyboard shortcuts
            useEffect(() => {
                const handleKeyDown = (e) => {
                    // Ctrl+S or Cmd+S - Quick Save
                    if ((e.ctrlKey || e.metaKey) && e.key === 's' && !e.shiftKey) {
                        e.preventDefault();
                        performQuickSave();
                    }
                    // Ctrl+Shift+S or Cmd+Shift+S - Save As
                    else if ((e.ctrlKey || e.metaKey) && e.key === 's' && e.shiftKey) {
                        e.preventDefault();
                        saveAsNewFile();
                    }
                    // Ctrl+N or Cmd+N - New Project
                    else if ((e.ctrlKey || e.metaKey) && e.key === 'n') {
                        e.preventDefault();
                        setShowNewProject(true);
                    }
                    // Ctrl+O or Cmd+O - Open Project
                    else if ((e.ctrlKey || e.metaKey) && e.key === 'o') {
                        e.preventDefault();
                        handleOpenProject();
                    }
                };
                
                document.addEventListener('keydown', handleKeyDown);
                return () => document.removeEventListener('keydown', handleKeyDown);
            }, [currentProject, scenes, chapters, characters, locations, notes]);

            const createProject = () => {
                if (!newProjectName.trim()) {
                    alert('Please enter a project name.');
                    return;
                }
                
                const newProject = {
                    id: Date.now().toString(),
                    name: newProjectName,
                    scenes: [],
                    chapters: [],
                    characters: [],
                    locations: [],
                    notes: [],
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                
                setCurrentProject(newProject);
                setScenes([]);
                setChapters([]);
                setCharacters([]);
                setLocations([]);
                setNotes([]);
                setNewProjectName('');
                setShowNewProject(false);
                setUnsavedChanges(false);
            };

            const closeProject = () => {
                if (unsavedChanges) {
                    if (!confirm('You have unsaved changes. Close without saving? All changes will be lost.')) {
                        return;
                    }
                }
                setCurrentProject(null);
                setScenes([]);
                setChapters([]);
                setCharacters([]);
                setLocations([]);
                setNotes([]);
                setEditingCard(null);
                setUnsavedChanges(false);
            };

            const saveProject = () => {
                if (!currentProject) return;
                setSaveFileName(currentProject.name);
                setShowSaveAs(true);
            };

            const performSave = () => {
                if (!currentProject) return;
                if (!saveFileName.trim()) {
                    alert('Please enter a file name.');
                    return;
                }
                
                const updatedProject = {
                    ...currentProject,
                    name: saveFileName
                };
                setCurrentProject(updatedProject);
                
                const dataStr = JSON.stringify({
                    name: saveFileName,
                    scenes: scenes,
                    chapters: chapters,
                    characters: characters,
                    locations: locations,
                    notes: notes,
                    exportedAt: new Date().toISOString()
                }, null, 2);
                
                const blob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                const filename = saveFileName.endsWith('.novelatta') ? saveFileName : `${saveFileName}.novelatta`;
                link.download = filename;
                link.click();
                URL.revokeObjectURL(url);
                
                setUnsavedChanges(false);
                setSaveSuccessMessage(true);
                setTimeout(() => setSaveSuccessMessage(false), 5000);
                
                setShowSaveAs(false);
            };

            const performQuickSave = () => {
                if (!currentProject) return;
                
                // Check if we should show first-time save notice
                const hasSeenSaveNotice = localStorage.getItem('novelatta_hasSeenSaveNotice');
                if (!hasSeenSaveNotice && currentProject.name && currentProject.name.trim()) {
                    setShowFirstSaveNotice(true);
                    return; // Wait for user to acknowledge before saving
                }
                
                // If project has been saved before (has a name), save directly
                if (currentProject.name && currentProject.name.trim()) {
                    setSaveFileName(currentProject.name);
                    setShowSaveAs(false); // Ensure modal is closed
                    // Call performSave directly with current project name
                    const filename = currentProject.name.endsWith('.novelatta') ? currentProject.name : `${currentProject.name}.novelatta`;
                    
                    const dataStr = JSON.stringify({
                        name: currentProject.name,
                        scenes: scenes,
                        chapters: chapters,
                        characters: characters,
                        locations: locations,
                        notes: notes,
                        exportedAt: new Date().toISOString()
                    }, null, 2);
                    
                    const blob = new Blob([dataStr], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = filename;
                    link.click();
                    URL.revokeObjectURL(url);
                    
                    setUnsavedChanges(false);
                    setSaveSuccessMessage(true);
                    setTimeout(() => setSaveSuccessMessage(false), 5000);
                } else {
                    // First time saving - show Save As dialog
                    setSaveFileName('');
                    setShowSaveAs(true);
                }
            };

            const proceedWithSave = () => {
                // Mark that user has seen the save notice
                localStorage.setItem('novelatta_hasSeenSaveNotice', 'true');
                
                setShowFirstSaveNotice(false);
                
                // Now actually perform the save
                if (currentProject && currentProject.name && currentProject.name.trim()) {
                    setSaveFileName(currentProject.name);
                    setShowSaveAs(false);
                    const filename = currentProject.name.endsWith('.novelatta') ? currentProject.name : `${currentProject.name}.novelatta`;
                    
                    const dataStr = JSON.stringify({
                        name: currentProject.name,
                        scenes: scenes,
                        chapters: chapters,
                        characters: characters,
                        locations: locations,
                        notes: notes,
                        exportedAt: new Date().toISOString()
                    }, null, 2);
                    
                    const blob = new Blob([dataStr], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = filename;
                    link.click();
                    URL.revokeObjectURL(url);
                    
                    setUnsavedChanges(false);
                    setSaveSuccessMessage(true);
                    setTimeout(() => setSaveSuccessMessage(false), 5000);
                }
            };

            const saveAsNewFile = () => {
                if (!currentProject) return;
                setSaveFileName(currentProject.name || '');
                setShowSaveAs(true);
            };

            const handleOpenProject = () => {
                if (unsavedChanges) {
                    if (!confirm('You have unsaved changes. Open a different project? All unsaved changes will be lost.')) {
                        return;
                    }
                }
                fileInputRef.current?.click();
            };

            const openProject = (e) => {
                const file = e.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (event) => {
                    try {
                        const data = JSON.parse(event.target.result);
                        
                        const newProject = {
                            id: Date.now().toString(),
                            name: file.name.replace('.novelatta', '') || 'Imported Project',
                            scenes: data.scenes || [],
                            chapters: data.chapters || [],
                            characters: data.characters || [],
                            locations: data.locations || [],
                            notes: data.notes || [],
                            createdAt: new Date().toISOString(),
                            updatedAt: new Date().toISOString()
                        };
                        
                        setCurrentProject(newProject);
                        setScenes(newProject.scenes);
                        setChapters(newProject.chapters);
                        setCharacters(newProject.characters);
                        setLocations(newProject.locations);
                        setNotes(newProject.notes);
                        setEditingCard(null);
                        setUnsavedChanges(false);
                        
                        alert(`Successfully opened "${newProject.name}"!`);
                    } catch (err) {
                        console.error('Import error:', err);
                        alert('Failed to open project. Please make sure this is a valid .novelatta file.');
                    }
                };
                reader.onerror = () => {
                    alert('Failed to read file. Please try again.');
                };
                reader.readAsText(file);
                e.target.value = '';
            };

            // Export functions
            const sanitizeFilename = (name) => {
                // Remove special characters that could cause issues
                return name.replace(/[^a-zA-Z0-9-_ ]/g, '').replace(/\s+/g, '-');
            };

            const escapeHTML = (str) => {
                if (!str) return '';
                return str.replace(/&/g, '&amp;')
                         .replace(/</g, '&lt;')
                         .replace(/>/g, '&gt;')
                         .replace(/"/g, '&quot;')
                         .replace(/'/g, '&#039;');
            };

            const downloadFile = (content, filename, type) => {
                const blob = new Blob([content], { type });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                link.style.display = 'none';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            };

            const exportScenesMarkdown = () => {
                if (!currentProject) return;
                let md = `# ${currentProject.name} - Scenes\n\n`;
                
                for (let act = 1; act <= 4; act++) {
                    const actName = act === 1 ? 'Setup and inciting incident' :
                                   act === 2 ? 'Reactive, try old solutions' :
                                   act === 3 ? 'Proactive, try new approach' :
                                   'Climax and resolution';
                    md += `## Act ${act}: ${actName}\n\n`;
                    
                    const actChapters = getChaptersByAct(act);
                    const actScenes = scenes.filter(s => s.act === act);
                    
                    actChapters.forEach(chapter => {
                        const chapterNum = getGlobalChapterNumber(chapter.id);
                        md += `### Chapter ${chapterNum}: ${chapter.name}\n\n`;
                        
                        const chapterScenes = actScenes.filter(s => s.chapterId === chapter.id);
                        chapterScenes.forEach(scene => {
                            md += `#### ${scene.title || 'Untitled Scene'} (${scene.type === 'action' ? 'Action' : 'Reaction'})\n\n`;
                            if (scene.type === 'action') {
                                if (scene.objective) md += `- **Objective:** ${scene.objective}\n`;
                                if (scene.obstacle) md += `- **Obstacle:** ${scene.obstacle}\n`;
                                if (scene.outcome) md += `- **Outcome:** ${scene.outcome}\n`;
                            } else {
                                if (scene.emotion) md += `- **Emotion:** ${scene.emotion}\n`;
                                if (scene.deliberation) md += `- **Deliberation:** ${scene.deliberation}\n`;
                                if (scene.decision) md += `- **Decision:** ${scene.decision}\n`;
                            }
                            if (scene.notes) md += `- **Notes:** ${scene.notes}\n`;
                            md += '\n';
                        });
                    });
                    
                    const unchapteredScenes = actScenes.filter(s => !s.chapterId);
                    if (unchapteredScenes.length > 0) {
                        md += `### Unchaptered Scenes\n\n`;
                        unchapteredScenes.forEach(scene => {
                            md += `#### ${scene.title || 'Untitled Scene'} (${scene.type === 'action' ? 'Action' : 'Reaction'})\n\n`;
                            if (scene.type === 'action') {
                                if (scene.objective) md += `- **Objective:** ${scene.objective}\n`;
                                if (scene.obstacle) md += `- **Obstacle:** ${scene.obstacle}\n`;
                                if (scene.outcome) md += `- **Outcome:** ${scene.outcome}\n`;
                            } else {
                                if (scene.emotion) md += `- **Emotion:** ${scene.emotion}\n`;
                                if (scene.deliberation) md += `- **Deliberation:** ${scene.deliberation}\n`;
                                if (scene.decision) md += `- **Decision:** ${scene.decision}\n`;
                            }
                            if (scene.notes) md += `- **Notes:** ${scene.notes}\n`;
                            md += '\n';
                        });
                    }
                }
                
                const filename = `${sanitizeFilename(currentProject.name)}-scenes.md`;
                downloadFile(md, filename, 'application/octet-stream');
            };

            const exportCharactersMarkdown = () => {
                if (!currentProject) return;
                let md = `# ${currentProject.name} - Characters\n\n`;
                
                characters.forEach(char => {
                    md += `## ${char.name || 'Unnamed Character'}`;
                    if (char.type) md += ` (${char.type.charAt(0).toUpperCase() + char.type.slice(1)})`;
                    md += '\n\n';
                    
                    if (char.role) md += `**Role:** ${char.role}\n\n`;
                    if (char.description) md += `**Description:** ${char.description}\n\n`;
                    if (char.personality) md += `**Personality:** ${char.personality}\n\n`;
                    if (char.backstory) md += `**Backstory:** ${char.backstory}\n\n`;
                    if (char.characterArc) md += `**Character Arc:** ${char.characterArc}\n\n`;
                    if (char.relationships) md += `**Relationships:** ${char.relationships}\n\n`;
                    if (char.firstAppearance) md += `**First Appearance:** ${char.firstAppearance}\n\n`;
                    if (char.notes) md += `**Notes:** ${char.notes}\n\n`;
                    md += '---\n\n';
                });
                
                const filename = `${sanitizeFilename(currentProject.name)}-characters.md`;
                downloadFile(md, filename, 'application/octet-stream');
            };

            const exportLocationsMarkdown = () => {
                if (!currentProject) return;
                let md = `# ${currentProject.name} - Locations\n\n`;
                
                locations.forEach(loc => {
                    md += `## ${loc.name || 'Unnamed Location'}`;
                    if (loc.type) md += ` (${loc.type.charAt(0).toUpperCase() + loc.type.slice(1)})`;
                    md += '\n\n';
                    
                    if (loc.description) md += `**Description:** ${loc.description}\n\n`;
                    if (loc.significance) md += `**Story Significance:** ${loc.significance}\n\n`;
                    if (loc.associatedCharacters) md += `**Associated Characters:** ${loc.associatedCharacters}\n\n`;
                    if (loc.notes) md += `**Notes:** ${loc.notes}\n\n`;
                    md += '---\n\n';
                });
                
                const filename = `${sanitizeFilename(currentProject.name)}-locations.md`;
                downloadFile(md, filename, 'application/octet-stream');
            };

            const exportNotesMarkdown = () => {
                if (!currentProject) return;
                let md = `# ${currentProject.name} - Notes\n\n`;
                
                const sortedNotes = [...notes].sort((a, b) => {
                    if (a.isPinned && !b.isPinned) return -1;
                    if (!a.isPinned && b.isPinned) return 1;
                    return new Date(b.updatedAt) - new Date(a.updatedAt);
                });
                
                sortedNotes.forEach(note => {
                    md += `## ${note.title || 'Untitled Note'}`;
                    if (note.isPinned) md += ' ðŸ“Œ';
                    md += '\n\n';
                    
                    if (note.content) md += `${note.content}\n\n`;
                    md += '---\n\n';
                });
                
                const filename = `${sanitizeFilename(currentProject.name)}-notes.md`;
                downloadFile(md, filename, 'application/octet-stream');
            };

            const exportFullProjectMarkdown = () => {
                if (!currentProject) return;
                let md = `# ${currentProject.name}\n\n`;
                md += `*Full Project Export*\n\n`;
                md += `---\n\n`;
                
                // Scenes
                md += `# Scenes\n\n`;
                for (let act = 1; act <= 4; act++) {
                    const actName = act === 1 ? 'Setup and inciting incident' :
                                   act === 2 ? 'Reactive, try old solutions' :
                                   act === 3 ? 'Proactive, try new approach' :
                                   'Climax and resolution';
                    md += `## Act ${act}: ${actName}\n\n`;
                    
                    const actChapters = getChaptersByAct(act);
                    const actScenes = scenes.filter(s => s.act === act);
                    
                    actChapters.forEach(chapter => {
                        const chapterNum = getGlobalChapterNumber(chapter.id);
                        md += `### Chapter ${chapterNum}: ${chapter.name}\n\n`;
                        
                        const chapterScenes = actScenes.filter(s => s.chapterId === chapter.id);
                        chapterScenes.forEach(scene => {
                            md += `#### ${scene.title || 'Untitled Scene'} (${scene.type === 'action' ? 'Action' : 'Reaction'})\n\n`;
                            if (scene.type === 'action') {
                                if (scene.objective) md += `- **Objective:** ${scene.objective}\n`;
                                if (scene.obstacle) md += `- **Obstacle:** ${scene.obstacle}\n`;
                                if (scene.outcome) md += `- **Outcome:** ${scene.outcome}\n`;
                            } else {
                                if (scene.emotion) md += `- **Emotion:** ${scene.emotion}\n`;
                                if (scene.deliberation) md += `- **Deliberation:** ${scene.deliberation}\n`;
                                if (scene.decision) md += `- **Decision:** ${scene.decision}\n`;
                            }
                            if (scene.notes) md += `- **Notes:** ${scene.notes}\n`;
                            md += '\n';
                        });
                    });
                    
                    const unchapteredScenes = actScenes.filter(s => !s.chapterId);
                    if (unchapteredScenes.length > 0) {
                        md += `### Unchaptered Scenes\n\n`;
                        unchapteredScenes.forEach(scene => {
                            md += `#### ${scene.title || 'Untitled Scene'} (${scene.type === 'action' ? 'Action' : 'Reaction'})\n\n`;
                            if (scene.type === 'action') {
                                if (scene.objective) md += `- **Objective:** ${scene.objective}\n`;
                                if (scene.obstacle) md += `- **Obstacle:** ${scene.obstacle}\n`;
                                if (scene.outcome) md += `- **Outcome:** ${scene.outcome}\n`;
                            } else {
                                if (scene.emotion) md += `- **Emotion:** ${scene.emotion}\n`;
                                if (scene.deliberation) md += `- **Deliberation:** ${scene.deliberation}\n`;
                                if (scene.decision) md += `- **Decision:** ${scene.decision}\n`;
                            }
                            if (scene.notes) md += `- **Notes:** ${scene.notes}\n`;
                            md += '\n';
                        });
                    }
                }
                
                // Characters
                md += `\n---\n\n# Characters\n\n`;
                characters.forEach(char => {
                    md += `## ${char.name || 'Unnamed Character'}`;
                    if (char.type) md += ` (${char.type.charAt(0).toUpperCase() + char.type.slice(1)})`;
                    md += '\n\n';
                    
                    if (char.role) md += `**Role:** ${char.role}\n\n`;
                    if (char.description) md += `**Description:** ${char.description}\n\n`;
                    if (char.personality) md += `**Personality:** ${char.personality}\n\n`;
                    if (char.backstory) md += `**Backstory:** ${char.backstory}\n\n`;
                    if (char.characterArc) md += `**Character Arc:** ${char.characterArc}\n\n`;
                    if (char.relationships) md += `**Relationships:** ${char.relationships}\n\n`;
                    if (char.firstAppearance) md += `**First Appearance:** ${char.firstAppearance}\n\n`;
                    if (char.notes) md += `**Notes:** ${char.notes}\n\n`;
                    md += '---\n\n';
                });
                
                // Locations
                md += `\n# Locations\n\n`;
                locations.forEach(loc => {
                    md += `## ${loc.name || 'Unnamed Location'}`;
                    if (loc.type) md += ` (${loc.type.charAt(0).toUpperCase() + loc.type.slice(1)})`;
                    md += '\n\n';
                    
                    if (loc.description) md += `**Description:** ${loc.description}\n\n`;
                    if (loc.significance) md += `**Story Significance:** ${loc.significance}\n\n`;
                    if (loc.associatedCharacters) md += `**Associated Characters:** ${loc.associatedCharacters}\n\n`;
                    if (loc.notes) md += `**Notes:** ${loc.notes}\n\n`;
                    md += '---\n\n';
                });
                
                // Notes
                md += `\n# Notes\n\n`;
                const sortedNotes = [...notes].sort((a, b) => {
                    if (a.isPinned && !b.isPinned) return -1;
                    if (!a.isPinned && b.isPinned) return 1;
                    return new Date(b.updatedAt) - new Date(a.updatedAt);
                });
                
                sortedNotes.forEach(note => {
                    md += `## ${note.title || 'Untitled Note'}`;
                    if (note.isPinned) md += ' ðŸ“Œ';
                    md += '\n\n';
                    
                    if (note.content) md += `${note.content}\n\n`;
                    md += '---\n\n';
                });
                
                const filename = `${sanitizeFilename(currentProject.name)}-full.md`;
                downloadFile(md, filename, 'application/octet-stream');
            };

            const exportScenesCSV = () => {
                if (!currentProject) return;
                const headers = ['Act', 'Chapter', 'ChapterName', 'Title', 'Type', 'Objective', 'Obstacle', 'Outcome', 'Emotion', 'Deliberation', 'Decision', 'Color', 'Notes'];
                let csv = headers.join(',') + '\n';
                
                scenes.forEach(scene => {
                    const chapterNum = scene.chapterId ? getGlobalChapterNumber(scene.chapterId) : '';
                    const chapterName = scene.chapterId ? chapters.find(c => c.id === scene.chapterId)?.name || '' : '';
                    
                    const row = [
                        scene.act,
                        chapterNum,
                        `"${chapterName.replace(/"/g, '""')}"`,
                        `"${(scene.title || '').replace(/"/g, '""')}"`,
                        scene.type,
                        `"${(scene.objective || '').replace(/"/g, '""')}"`,
                        `"${(scene.obstacle || '').replace(/"/g, '""')}"`,
                        `"${(scene.outcome || '').replace(/"/g, '""')}"`,
                        `"${(scene.emotion || '').replace(/"/g, '""')}"`,
                        `"${(scene.deliberation || '').replace(/"/g, '""')}"`,
                        `"${(scene.decision || '').replace(/"/g, '""')}"`,
                        scene.color,
                        `"${(scene.notes || '').replace(/"/g, '""')}"`
                    ];
                    csv += row.join(',') + '\n';
                });
                
                const filename = `${sanitizeFilename(currentProject.name)}-scenes.csv`;
                downloadFile(csv, filename, 'text/csv');
            };

            const exportCharactersCSV = () => {
                if (!currentProject) return;
                const headers = ['Name', 'Type', 'Role', 'Description', 'Personality', 'Backstory', 'CharacterArc', 'Relationships', 'FirstAppearance', 'Notes', 'Color'];
                let csv = headers.join(',') + '\n';
                
                characters.forEach(char => {
                    const row = [
                        `"${(char.name || '').replace(/"/g, '""')}"`,
                        char.type || '',
                        `"${(char.role || '').replace(/"/g, '""')}"`,
                        `"${(char.description || '').replace(/"/g, '""')}"`,
                        `"${(char.personality || '').replace(/"/g, '""')}"`,
                        `"${(char.backstory || '').replace(/"/g, '""')}"`,
                        `"${(char.characterArc || '').replace(/"/g, '""')}"`,
                        `"${(char.relationships || '').replace(/"/g, '""')}"`,
                        `"${(char.firstAppearance || '').replace(/"/g, '""')}"`,
                        `"${(char.notes || '').replace(/"/g, '""')}"`,
                        char.color
                    ];
                    csv += row.join(',') + '\n';
                });
                
                const filename = `${sanitizeFilename(currentProject.name)}-characters.csv`;
                downloadFile(csv, filename, 'text/csv');
            };

            const exportLocationsCSV = () => {
                if (!currentProject) return;
                const headers = ['Name', 'Type', 'Description', 'Significance', 'AssociatedCharacters', 'Notes', 'Color'];
                let csv = headers.join(',') + '\n';
                
                locations.forEach(loc => {
                    const row = [
                        `"${(loc.name || '').replace(/"/g, '""')}"`,
                        loc.type || '',
                        `"${(loc.description || '').replace(/"/g, '""')}"`,
                        `"${(loc.significance || '').replace(/"/g, '""')}"`,
                        `"${(loc.associatedCharacters || '').replace(/"/g, '""')}"`,
                        `"${(loc.notes || '').replace(/"/g, '""')}"`,
                        loc.color
                    ];
                    csv += row.join(',') + '\n';
                });
                
                const filename = `${sanitizeFilename(currentProject.name)}-locations.csv`;
                downloadFile(csv, filename, 'text/csv');
            };

            const exportNotesCSV = () => {
                if (!currentProject) return;
                const headers = ['Title', 'Content', 'IsPinned', 'Color'];
                let csv = headers.join(',') + '\n';
                
                notes.forEach(note => {
                    const row = [
                        `"${(note.title || '').replace(/"/g, '""')}"`,
                        `"${(note.content || '').replace(/"/g, '""')}"`,
                        note.isPinned ? 'Yes' : 'No',
                        note.color
                    ];
                    csv += row.join(',') + '\n';
                });
                
                const filename = `${sanitizeFilename(currentProject.name)}-notes.csv`;
                downloadFile(csv, filename, 'text/csv');
            };

            const exportFullProjectHTML = () => {
                if (!currentProject) return;
                
                let html = `<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${escapeHTML(currentProject.name)} - Project Report</title>
    <style>
        body {
            font-family: 'Georgia', serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px 15px;
            line-height: 1.4;
            color: #1f2937;
            background: #ffffff;
        }
        h1 {
            color: #4f46e5;
            border-bottom: 4px solid #4f46e5;
            padding-bottom: 12px;
            margin-bottom: 15px;
            font-size: 2em;
        }
        h2 {
            color: #4f46e5;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.5em;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 8px;
        }
        h3 {
            color: #6366f1;
            margin-top: 15px;
            margin-bottom: 8px;
            font-size: 1.2em;
        }
        h4 {
            color: #374151;
            margin-top: 10px;
            margin-bottom: 6px;
            font-size: 1.1em;
        }
        .scene {
            background: #f9fafb;
            padding: 12px;
            margin: 12px 0;
            border-radius: 8px;
            border-left: 4px solid #4f46e5;
        }
        .character, .location, .note {
            background: #f9fafb;
            padding: 12px;
            margin: 12px 0;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
        .note {
            border-left-color: #8b5cf6;
        }
        .location {
            border-left-color: #10b981;
        }
        .field-label {
            font-weight: 600;
            color: #6b7280;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .field-value {
            margin-top: 2px;
            margin-bottom: 6px;
        }
        .type-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 600;
            margin-left: 8px;
        }
        .type-action {
            background: #dbeafe;
            color: #1e40af;
        }
        .type-reaction {
            background: #fef3c7;
            color: #92400e;
        }
        .pinned-badge {
            background: #fef3c7;
            color: #92400e;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.85em;
            font-weight: 600;
            margin-left: 8px;
        }
        .section-divider {
            height: 2px;
            background: linear-gradient(to right, #4f46e5, transparent);
            margin: 25px 0;
        }
        @media print {
            body { padding: 15px; }
            .scene, .character, .location, .note { break-inside: avoid; }
        }
    </style>
</head>
<body>
    <h1>${escapeHTML(currentProject.name)}</h1>
    <p style="color: #6b7280; font-style: italic;">Full Project Report</p>
`;

                // Scenes
                html += `<div class="section-divider"></div>\n<h2>ðŸ“‹ Scenes</h2>\n`;
                
                for (let act = 1; act <= 4; act++) {
                    const actName = act === 1 ? 'Setup and inciting incident' :
                                   act === 2 ? 'Reactive, try old solutions' :
                                   act === 3 ? 'Proactive, try new approach' :
                                   'Climax and resolution';
                    html += `<h3>Act ${act}: ${actName}</h3>\n`;
                    
                    const actChapters = getChaptersByAct(act);
                    const actScenes = scenes.filter(s => s.act === act);
                    
                    actChapters.forEach(chapter => {
                        const chapterNum = getGlobalChapterNumber(chapter.id);
                        html += `<h4>Chapter ${chapterNum}: ${escapeHTML(chapter.name)}</h4>\n`;
                        
                        const chapterScenes = actScenes.filter(s => s.chapterId === chapter.id);
                        chapterScenes.forEach(scene => {
                            const typeBadge = scene.type === 'action' ? 
                                '<span class="type-badge type-action">Action</span>' : 
                                '<span class="type-badge type-reaction">Reaction</span>';
                            
                            html += `<div class="scene">\n`;
                            html += `<h4>${escapeHTML(scene.title) || 'Untitled Scene'}${typeBadge}</h4>\n`;
                            
                            if (scene.type === 'action') {
                                if (scene.objective) html += `<div class="field-label">Objective</div><div class="field-value">${escapeHTML(scene.objective)}</div>\n`;
                                if (scene.obstacle) html += `<div class="field-label">Obstacle</div><div class="field-value">${escapeHTML(scene.obstacle)}</div>\n`;
                                if (scene.outcome) html += `<div class="field-label">Outcome</div><div class="field-value">${escapeHTML(scene.outcome)}</div>\n`;
                            } else {
                                if (scene.emotion) html += `<div class="field-label">Emotion</div><div class="field-value">${escapeHTML(scene.emotion)}</div>\n`;
                                if (scene.deliberation) html += `<div class="field-label">Deliberation</div><div class="field-value">${escapeHTML(scene.deliberation)}</div>\n`;
                                if (scene.decision) html += `<div class="field-label">Decision</div><div class="field-value">${escapeHTML(scene.decision)}</div>\n`;
                            }
                            if (scene.notes) html += `<div class="field-label">Notes</div><div class="field-value">${escapeHTML(scene.notes)}</div>\n`;
                            html += `</div>\n`;
                        });
                    });
                    
                    const unchapteredScenes = actScenes.filter(s => !s.chapterId);
                    if (unchapteredScenes.length > 0) {
                        html += `<h4>Unchaptered Scenes</h4>\n`;
                        unchapteredScenes.forEach(scene => {
                            const typeBadge = scene.type === 'action' ? 
                                '<span class="type-badge type-action">Action</span>' : 
                                '<span class="type-badge type-reaction">Reaction</span>';
                            
                            html += `<div class="scene">\n`;
                            html += `<h4>${escapeHTML(scene.title) || 'Untitled Scene'}${typeBadge}</h4>\n`;
                            
                            if (scene.type === 'action') {
                                if (scene.objective) html += `<div class="field-label">Objective</div><div class="field-value">${escapeHTML(scene.objective)}</div>\n`;
                                if (scene.obstacle) html += `<div class="field-label">Obstacle</div><div class="field-value">${escapeHTML(scene.obstacle)}</div>\n`;
                                if (scene.outcome) html += `<div class="field-label">Outcome</div><div class="field-value">${escapeHTML(scene.outcome)}</div>\n`;
                            } else {
                                if (scene.emotion) html += `<div class="field-label">Emotion</div><div class="field-value">${escapeHTML(scene.emotion)}</div>\n`;
                                if (scene.deliberation) html += `<div class="field-label">Deliberation</div><div class="field-value">${escapeHTML(scene.deliberation)}</div>\n`;
                                if (scene.decision) html += `<div class="field-label">Decision</div><div class="field-value">${escapeHTML(scene.decision)}</div>\n`;
                            }
                            if (scene.notes) html += `<div class="field-label">Notes</div><div class="field-value">${escapeHTML(scene.notes)}</div>\n`;
                            html += `</div>\n`;
                        });
                    }
                }
                
                // Characters
                html += `<div class="section-divider"></div>\n<h2>ðŸ‘¥ Characters</h2>\n`;
                characters.forEach(char => {
                    html += `<div class="character">\n`;
                    html += `<h3>${escapeHTML(char.name) || 'Unnamed Character'}`;
                    if (char.type) html += ` <span style="color: #6b7280; font-weight: normal; font-size: 0.8em;">(${char.type.charAt(0).toUpperCase() + char.type.slice(1)})</span>`;
                    html += `</h3>\n`;
                    
                    if (char.role) html += `<div class="field-label">Role</div><div class="field-value">${escapeHTML(char.role)}</div>\n`;
                    if (char.description) html += `<div class="field-label">Description</div><div class="field-value">${escapeHTML(char.description)}</div>\n`;
                    if (char.personality) html += `<div class="field-label">Personality</div><div class="field-value">${escapeHTML(char.personality)}</div>\n`;
                    if (char.backstory) html += `<div class="field-label">Backstory</div><div class="field-value">${escapeHTML(char.backstory)}</div>\n`;
                    if (char.characterArc) html += `<div class="field-label">Character Arc</div><div class="field-value">${escapeHTML(char.characterArc)}</div>\n`;
                    if (char.relationships) html += `<div class="field-label">Relationships</div><div class="field-value">${escapeHTML(char.relationships)}</div>\n`;
                    if (char.firstAppearance) html += `<div class="field-label">First Appearance</div><div class="field-value">${escapeHTML(char.firstAppearance)}</div>\n`;
                    if (char.notes) html += `<div class="field-label">Notes</div><div class="field-value">${escapeHTML(char.notes)}</div>\n`;
                    html += `</div>\n`;
                });
                
                // Locations
                html += `<div class="section-divider"></div>\n<h2>ðŸ—ºï¸ Locations</h2>\n`;
                locations.forEach(loc => {
                    html += `<div class="location">\n`;
                    html += `<h3>${escapeHTML(loc.name) || 'Unnamed Location'}`;
                    if (loc.type) html += ` <span style="color: #6b7280; font-weight: normal; font-size: 0.8em;">(${loc.type.charAt(0).toUpperCase() + loc.type.slice(1)})</span>`;
                    html += `</h3>\n`;
                    
                    if (loc.description) html += `<div class="field-label">Description</div><div class="field-value">${escapeHTML(loc.description)}</div>\n`;
                    if (loc.significance) html += `<div class="field-label">Story Significance</div><div class="field-value">${escapeHTML(loc.significance)}</div>\n`;
                    if (loc.associatedCharacters) html += `<div class="field-label">Associated Characters</div><div class="field-value">${escapeHTML(loc.associatedCharacters)}</div>\n`;
                    if (loc.notes) html += `<div class="field-label">Notes</div><div class="field-value">${escapeHTML(loc.notes)}</div>\n`;
                    html += `</div>\n`;
                });
                
                // Notes
                html += `<div class="section-divider"></div>\n<h2>ðŸ“ Notes</h2>\n`;
                const sortedNotes = [...notes].sort((a, b) => {
                    if (a.isPinned && !b.isPinned) return -1;
                    if (!a.isPinned && b.isPinned) return 1;
                    return new Date(b.updatedAt) - new Date(a.updatedAt);
                });
                
                sortedNotes.forEach(note => {
                    html += `<div class="note">\n`;
                    html += `<h3>${escapeHTML(note.title) || 'Untitled Note'}`;
                    if (note.isPinned) html += '<span class="pinned-badge">ðŸ“Œ Pinned</span>';
                    html += `</h3>\n`;
                    
                    if (note.content) html += `<div class="field-value">${escapeHTML(note.content).replace(/\n/g, '<br>')}</div>\n`;
                    html += `</div>\n`;
                });
                
                html += `</body>\n</html>`;
                
                const filename = `${sanitizeFilename(currentProject.name)}-report.html`;
                downloadFile(html, filename, 'text/html');
            };

            // Character functions
            const addCharacter = () => {
                if (!currentProject) return;
                const newCharacter = {
                    id: Date.now().toString(),
                    name: '',
                    type: 'supporting',
                    role: '',
                    description: '',
                    personality: '',
                    backstory: '',
                    arc: '',
                    relationships: '',
                    firstAppearance: '',
                    notes: '',
                    createdAt: new Date().toISOString()
                };
                setCharacters([...characters, newCharacter]);
                setEditingCard(newCharacter.id);
                setShowModal(true);
            };

            const updateCharacter = (id, updates) => {
                setCharacters(characters.map(c => 
                    c.id === id ? { ...c, ...updates } : c
                ));
            };

            const deleteCharacter = (id) => {
                if (confirm('Are you sure you want to delete this character?')) {
                    setCharacters(characters.filter(c => c.id !== id));
                    if (expandedCard === id) setExpandedCard(null);
                    if (editingCard === id) {
                        setEditingCard(null);
                        setShowModal(false);
                    }
                }
            };

            // Location functions
            const addLocation = () => {
                if (!currentProject) return;
                const newLocation = {
                    id: Date.now().toString(),
                    name: '',
                    type: 'building',
                    description: '',
                    significance: '',
                    associatedCharacters: '',
                    notes: '',
                    createdAt: new Date().toISOString()
                };
                setLocations([...locations, newLocation]);
                setEditingCard(newLocation.id);
                setShowModal(true);
            };

            const updateLocation = (id, updates) => {
                setLocations(locations.map(l => 
                    l.id === id ? { ...l, ...updates } : l
                ));
            };

            const deleteLocation = (id) => {
                if (confirm('Are you sure you want to delete this location?')) {
                    setLocations(locations.filter(l => l.id !== id));
                    if (expandedCard === id) setExpandedCard(null);
                    if (editingCard === id) {
                        setEditingCard(null);
                        setShowModal(false);
                    }
                }
            };

            // Drag handlers for characters
            const handleCharacterDragStart = (e, character) => {
                setDraggedCharacter(character);
                e.dataTransfer.effectAllowed = 'move';
            };

            const handleCharacterDragOver = (e) => {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
            };

            const handleCharacterDrop = (e, targetCharacter) => {
                e.preventDefault();
                if (!draggedCharacter || draggedCharacter.id === targetCharacter.id) {
                    setDraggedCharacter(null);
                    return;
                }

                const draggedIndex = characters.findIndex(c => c.id === draggedCharacter.id);
                const targetIndex = characters.findIndex(c => c.id === targetCharacter.id);

                const newCharacters = [...characters];
                const [removed] = newCharacters.splice(draggedIndex, 1);
                newCharacters.splice(targetIndex, 0, removed);

                setCharacters(newCharacters);
                setDraggedCharacter(null);
            };

            // Drag handlers for locations
            const handleLocationDragStart = (e, location) => {
                setDraggedLocation(location);
                e.dataTransfer.effectAllowed = 'move';
            };

            const handleLocationDragOver = (e) => {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
            };

            const handleLocationDrop = (e, targetLocation) => {
                e.preventDefault();
                if (!draggedLocation || draggedLocation.id === targetLocation.id) {
                    setDraggedLocation(null);
                    return;
                }

                const draggedIndex = locations.findIndex(l => l.id === draggedLocation.id);
                const targetIndex = locations.findIndex(l => l.id === targetLocation.id);

                const newLocations = [...locations];
                const [removed] = newLocations.splice(draggedIndex, 1);
                newLocations.splice(targetIndex, 0, removed);

                setLocations(newLocations);
                setDraggedLocation(null);
            };

            // Note management functions
            const addNote = () => {
                const newNote = {
                    id: `note_${Date.now()}`,
                    title: '',
                    content: '',
                    color: COLORS[0].className,
                    isPinned: false,
                    createdAt: new Date().toISOString(),
                    updatedAt: new Date().toISOString()
                };
                setNotes([...notes, newNote]);
                setEditingCard(newNote.id);
                setShowModal(true);
            };

            const updateNote = (id, updates) => {
                setNotes(notes.map(n => 
                    n.id === id ? { ...n, ...updates, updatedAt: new Date().toISOString() } : n
                ));
            };

            const deleteNote = (id) => {
                if (confirm('Delete this note? This cannot be undone.')) {
                    setNotes(notes.filter(n => n.id !== id));
                }
            };

            // Scene management functions
            const addScene = (act, chapterId = null) => {
                const newScene = {
                    id: Date.now().toString(),
                    act: act,
                    chapterId: chapterId,
                    type: 'action',
                    title: '',
                    color: COLORS[0].className,
                    objective: '',
                    obstacle: '',
                    outcome: '',
                    emotion: '',
                    deliberation: '',
                    decision: '',
                    notes: ''
                };
                setScenes([...scenes, newScene]);
                setEditingScene(newScene.id);
            };

            const updateScene = (id, updates) => {
                setScenes(scenes.map(s => s.id === id ? { ...s, ...updates } : s));
            };

            const deleteScene = (id) => {
                if (confirm('Delete this scene? This cannot be undone.')) {
                    setScenes(scenes.filter(s => s.id !== id));
                    if (editingScene === id) setEditingScene(null);
                }
            };

            const addChapter = (act, name) => {
                const newChapter = {
                    id: `ch_${Date.now()}`,
                    act: act,
                    name: name,
                    order: chapters.filter(c => c.act === act).length,
                    collapsed: false
                };
                setChapters([...chapters, newChapter]);
            };

            const deleteChapter = (chapterId) => {
                if (!confirm('Delete this chapter? Scenes will become unchaptered. This cannot be undone.')) return;
                setChapters(chapters.filter(c => c.id !== chapterId));
                setScenes(scenes.map(s => 
                    s.chapterId === chapterId ? { ...s, chapterId: null } : s
                ));
            };

            const updateChapter = (chapterId, updates) => {
                setChapters(chapters.map(c => 
                    c.id === chapterId ? { ...c, ...updates } : c
                ));
            };

            const toggleChapterCollapse = (chapterId) => {
                setChapters(chapters.map(c => 
                    c.id === chapterId ? { ...c, collapsed: !c.collapsed } : c
                ));
            };

            const moveChapterUp = (chapterId) => {
                const chapter = chapters.find(c => c.id === chapterId);
                if (!chapter) return;
                
                const actChapters = chapters.filter(c => c.act === chapter.act).sort((a, b) => a.order - b.order);
                const currentIndex = actChapters.findIndex(c => c.id === chapterId);
                
                if (currentIndex <= 0) return;
                
                const updatedChapters = chapters.map(c => {
                    if (c.id === chapterId) {
                        return { ...c, order: actChapters[currentIndex - 1].order };
                    } else if (c.id === actChapters[currentIndex - 1].id) {
                        return { ...c, order: chapter.order };
                    }
                    return c;
                });
                
                setChapters(updatedChapters);
            };

            const moveChapterDown = (chapterId) => {
                const chapter = chapters.find(c => c.id === chapterId);
                if (!chapter) return;
                
                const actChapters = chapters.filter(c => c.act === chapter.act).sort((a, b) => a.order - b.order);
                const currentIndex = actChapters.findIndex(c => c.id === chapterId);
                
                if (currentIndex >= actChapters.length - 1) return;
                
                const updatedChapters = chapters.map(c => {
                    if (c.id === chapterId) {
                        return { ...c, order: actChapters[currentIndex + 1].order };
                    } else if (c.id === actChapters[currentIndex + 1].id) {
                        return { ...c, order: chapter.order };
                    }
                    return c;
                });
                
                setChapters(updatedChapters);
            };

            const isFirstChapter = (chapterId, act) => {
                const actChapters = chapters.filter(c => c.act === act).sort((a, b) => a.order - b.order);
                return actChapters.length > 0 && actChapters[0].id === chapterId;
            };

            const isLastChapter = (chapterId, act) => {
                const actChapters = chapters.filter(c => c.act === act).sort((a, b) => a.order - b.order);
                return actChapters.length > 0 && actChapters[actChapters.length - 1].id === chapterId;
            };

            // Scene drag handlers
            const handleSceneDragStart = (e, scene) => {
                setDraggedScene(scene);
                e.dataTransfer.effectAllowed = 'move';
            };

            const handleSceneDragOver = (e, chapterId = null) => {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
                if (chapterId !== null) {
                    setDragOverChapter(chapterId);
                }
            };

            const handleSceneDragLeave = () => {
                setDragOverChapter(null);
            };

            const handleSceneDrop = (e, targetScene, targetAct, targetChapterId = null) => {
                e.preventDefault();
                setDragOverChapter(null);
                if (!draggedScene) return;

                const draggedIndex = scenes.findIndex(s => s.id === draggedScene.id);
                let targetIndex;

                if (targetScene) {
                    targetIndex = scenes.findIndex(s => s.id === targetScene.id);
                } else {
                    targetIndex = scenes.filter(s => s.act === targetAct && s.chapterId === targetChapterId).length + 
                                 scenes.filter((s, i) => i < scenes.length && (s.act < targetAct || (s.act === targetAct && s.chapterId !== targetChapterId))).length;
                }

                const newScenes = [...scenes];
                const [removed] = newScenes.splice(draggedIndex, 1);
                removed.act = targetAct;
                removed.chapterId = targetChapterId;

                if (draggedIndex < targetIndex) {
                    targetIndex--;
                }

                newScenes.splice(targetIndex, 0, removed);
                setScenes(newScenes);
                setDraggedScene(null);
            };

            const getScenesByChapter = (chapterId) => {
                const filteredScenes = getFilteredScenes();
                return filteredScenes.filter(s => s.chapterId === chapterId);
            };

            const getUnchapteredScenes = (act) => {
                const filteredScenes = getFilteredScenes();
                return filteredScenes.filter(s => s.act === act && !s.chapterId);
            };

            const getChaptersByAct = (act) => {
                return chapters.filter(c => c.act === act).sort((a, b) => a.order - b.order);
            };

            const getChapterNumber = (chapterId, act) => {
                if (!chapterId) return 'â€”';
                const actChapters = getChaptersByAct(act);
                const index = actChapters.findIndex(c => c.id === chapterId);
                return index >= 0 ? index + 1 : 'â€”';
            };

            const getGlobalChapterNumber = (chapterId) => {
                if (!chapterId) return 'â€”';
                
                // Get ALL chapters across all acts in order
                const allChapters = [];
                for (let act = 1; act <= 4; act++) {
                    allChapters.push(...getChaptersByAct(act));
                }
                
                // Find index of this chapter
                const index = allChapters.findIndex(c => c.id === chapterId);
                return index >= 0 ? index + 1 : 'â€”';
            };

            const getScenesInOrder = (scenesToOrder) => {
                const orderedScenes = [];
                
                // For each act
                for (let act = 1; act <= 4; act++) {
                    // Get chapters for this act in order
                    const actChapters = getChaptersByAct(act);
                    
                    // For each chapter, add its scenes in order
                    actChapters.forEach(chapter => {
                        const chapterScenes = scenesToOrder.filter(s => 
                            s.act === act && s.chapterId === chapter.id
                        );
                        orderedScenes.push(...chapterScenes);
                    });
                    
                    // Add unchaptered scenes for this act
                    const unchapteredScenes = scenesToOrder.filter(s => 
                        s.act === act && !s.chapterId
                    );
                    orderedScenes.push(...unchapteredScenes);
                }
                
                return orderedScenes;
            };

            // Filter functions
            const filteredCharacters = characters.filter(c => {
                const query = searchQuery.toLowerCase();
                return (
                    (c.name && c.name.toLowerCase().includes(query)) ||
                    (c.type && c.type.toLowerCase().includes(query)) ||
                    (c.role && c.role.toLowerCase().includes(query)) ||
                    (c.description && c.description.toLowerCase().includes(query)) ||
                    (c.personality && c.personality.toLowerCase().includes(query)) ||
                    (c.backstory && c.backstory.toLowerCase().includes(query)) ||
                    (c.characterArc && c.characterArc.toLowerCase().includes(query)) ||
                    (c.relationships && c.relationships.toLowerCase().includes(query)) ||
                    (c.firstAppearance && c.firstAppearance.toLowerCase().includes(query)) ||
                    (c.notes && c.notes.toLowerCase().includes(query))
                );
            });

            const filteredLocations = locations.filter(l => {
                const query = searchQuery.toLowerCase();
                return (
                    (l.name && l.name.toLowerCase().includes(query)) ||
                    (l.type && l.type.toLowerCase().includes(query)) ||
                    (l.description && l.description.toLowerCase().includes(query)) ||
                    (l.significance && l.significance.toLowerCase().includes(query)) ||
                    (l.associatedCharacters && l.associatedCharacters.toLowerCase().includes(query)) ||
                    (l.notes && l.notes.toLowerCase().includes(query))
                );
            });

            const filteredNotes = notes.filter(n => {
                const query = searchQuery.toLowerCase();
                return (
                    (n.title && n.title.toLowerCase().includes(query)) ||
                    (n.content && n.content.toLowerCase().includes(query))
                );
            }).sort((a, b) => {
                // Pinned notes first
                if (a.isPinned && !b.isPinned) return -1;
                if (!a.isPinned && b.isPinned) return 1;
                // Then by updated date (newest first)
                return new Date(b.updatedAt) - new Date(a.updatedAt);
            });

            return (
                <div>
                    {/* Header */}
                    <header className="header">
                        <div className="header-content">
                            <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                                <img src="data:image/webp;base64,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" alt="Novelatta Logo" style={{ width: '40px', height: '40px', marginRight: '12px' }} />
                                <h1 className="header-title">
                                    Novelatta
                                </h1>
                                {currentProject && (
                                    <>
                                        <div style={{
                                            width: '1px',
                                            height: '24px',
                                            background: 'rgba(255, 255, 255, 0.3)'
                                        }}></div>
                                        <div style={{
                                            color: '#ffffff',
                                            fontSize: '16px',
                                            fontWeight: 600,
                                            background: 'rgba(255, 255, 255, 0.2)',
                                            padding: '6px 12px',
                                            borderRadius: '6px',
                                            display: 'flex',
                                            alignItems: 'center',
                                            gap: '8px'
                                        }}>
                                            <span>ðŸ“„</span>
                                            <span>{currentProject.name}</span>
                                            {unsavedChanges && (
                                                <span style={{ 
                                                    fontSize: '14px', 
                                                    color: 'rgba(255, 255, 255, 0.7)' 
                                                }}>*</span>
                                            )}
                                        </div>
                                    </>
                                )}
                            </div>
                            
                            <div style={{ display: 'flex', alignItems: 'center', gap: '12px', flexWrap: 'wrap' }}>
                                {/* File Menu */}
                                <div style={{ position: 'relative' }} className="file-menu-container">
                                    <button
                                        onClick={() => setShowFileMenu(!showFileMenu)}
                                        className="btn btn-secondary"
                                        style={{ minWidth: '80px' }}
                                    >
                                        File â–¼
                                    </button>
                                    {showFileMenu && (
                                        <div
                                            style={{
                                                position: 'absolute',
                                                top: '100%',
                                                left: 0,
                                                marginTop: '4px',
                                                backgroundColor: 'white',
                                                border: '1px solid #e5e7eb',
                                                borderRadius: '8px',
                                                boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)',
                                                minWidth: '220px',
                                                zIndex: 1000,
                                                padding: '8px 0'
                                            }}
                                            onClick={(e) => e.stopPropagation()}
                                        >
                                            <button
                                                onClick={() => { setShowNewProject(true); setShowFileMenu(false); }}
                                                style={{
                                                    width: '100%',
                                                    padding: '10px 16px',
                                                    textAlign: 'left',
                                                    border: 'none',
                                                    background: 'none',
                                                    cursor: 'pointer',
                                                    fontSize: '14px',
                                                    color: '#374151',
                                                    display: 'flex',
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center'
                                                }}
                                                onMouseEnter={(e) => e.target.style.backgroundColor = '#f3f4f6'}
                                                onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                            >
                                                <span>+ New Project</span>
                                                <span style={{ fontSize: '11px', color: '#9ca3af' }}>Ctrl+N</span>
                                            </button>
                                            <button
                                                onClick={() => { handleOpenProject(); setShowFileMenu(false); }}
                                                style={{
                                                    width: '100%',
                                                    padding: '10px 16px',
                                                    textAlign: 'left',
                                                    border: 'none',
                                                    background: 'none',
                                                    cursor: 'pointer',
                                                    fontSize: '14px',
                                                    color: '#374151',
                                                    display: 'flex',
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center'
                                                }}
                                                onMouseEnter={(e) => e.target.style.backgroundColor = '#f3f4f6'}
                                                onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                            >
                                                <span>ðŸ“‚ Open Project...</span>
                                                <span style={{ fontSize: '11px', color: '#9ca3af' }}>Ctrl+O</span>
                                            </button>
                                            <div style={{ borderTop: '1px solid #e5e7eb', margin: '8px 0' }}></div>
                                            <button
                                                onClick={() => { performQuickSave(); setShowFileMenu(false); }}
                                                disabled={!currentProject}
                                                style={{
                                                    width: '100%',
                                                    padding: '10px 16px',
                                                    textAlign: 'left',
                                                    border: 'none',
                                                    background: 'none',
                                                    cursor: currentProject ? 'pointer' : 'not-allowed',
                                                    fontSize: '14px',
                                                    color: currentProject ? '#374151' : '#9ca3af',
                                                    opacity: currentProject ? 1 : 0.5,
                                                    display: 'flex',
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center'
                                                }}
                                                onMouseEnter={(e) => { if (currentProject) e.target.style.backgroundColor = '#f3f4f6'; }}
                                                onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                            >
                                                <span>ðŸ’¾ Save</span>
                                                <span style={{ fontSize: '11px', color: '#9ca3af' }}>Ctrl+S</span>
                                            </button>
                                            <button
                                                onClick={() => { saveAsNewFile(); setShowFileMenu(false); }}
                                                disabled={!currentProject}
                                                style={{
                                                    width: '100%',
                                                    padding: '10px 16px',
                                                    textAlign: 'left',
                                                    border: 'none',
                                                    background: 'none',
                                                    cursor: currentProject ? 'pointer' : 'not-allowed',
                                                    fontSize: '14px',
                                                    color: currentProject ? '#374151' : '#9ca3af',
                                                    opacity: currentProject ? 1 : 0.5,
                                                    display: 'flex',
                                                    justifyContent: 'space-between',
                                                    alignItems: 'center'
                                                }}
                                                onMouseEnter={(e) => { if (currentProject) e.target.style.backgroundColor = '#f3f4f6'; }}
                                                onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                            >
                                                <span>ðŸ’¾ Save As...</span>
                                                <span style={{ fontSize: '11px', color: '#9ca3af' }}>Ctrl+Shift+S</span>
                                            </button>
                                            <div style={{ borderTop: '1px solid #e5e7eb', margin: '8px 0' }}></div>
                                            <button
                                                onClick={() => { closeProject(); setShowFileMenu(false); }}
                                                disabled={!currentProject}
                                                style={{
                                                    width: '100%',
                                                    padding: '10px 16px',
                                                    textAlign: 'left',
                                                    border: 'none',
                                                    background: 'none',
                                                    cursor: currentProject ? 'pointer' : 'not-allowed',
                                                    fontSize: '14px',
                                                    color: currentProject ? '#374151' : '#9ca3af',
                                                    opacity: currentProject ? 1 : 0.5
                                                }}
                                                onMouseEnter={(e) => { if (currentProject) e.target.style.backgroundColor = '#f3f4f6'; }}
                                                onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                            >
                                                âœ• Close Project
                                            </button>
                                        </div>
                                    )}
                                </div>

                                {/* Quick Save Button (always visible when project open) */}
                                {currentProject && (
                                    <>
                                        {saveSuccessMessage && (
                                            <span style={{ color: '#10b981', fontWeight: 500, fontSize: '13px' }}>
                                                âœ“ Saved
                                            </span>
                                        )}
                                        {!saveSuccessMessage && unsavedChanges && (
                                            <span style={{ color: '#fbbf24', fontWeight: 500, fontSize: '13px' }}>
                                                âš ï¸ Unsaved
                                            </span>
                                        )}
                                        <button
                                            onClick={performQuickSave}
                                            className="btn btn-primary"
                                            title="Quick save (Ctrl+S)"
                                        >
                                            ðŸ’¾ Save
                                        </button>
                                        {/* Export Menu */}
                                        <div style={{ position: 'relative' }}>
                                            <button
                                                onClick={() => setShowExportMenu(!showExportMenu)}
                                                className="btn btn-secondary"
                                                title="Export your project data"
                                            >
                                                ðŸ“¤ Export â–¼
                                            </button>
                                            {showExportMenu && (
                                                <div
                                                    style={{
                                                        position: 'absolute',
                                                        top: '100%',
                                                        right: 0,
                                                        marginTop: '8px',
                                                        backgroundColor: 'white',
                                                        border: '1px solid #e5e7eb',
                                                        borderRadius: '8px',
                                                        boxShadow: '0 4px 6px -1px rgba(0, 0, 0, 0.1)',
                                                        minWidth: '220px',
                                                        zIndex: 1000,
                                                        padding: '8px 0'
                                                    }}
                                                    onClick={(e) => e.stopPropagation()}
                                                >
                                                    <div style={{ padding: '8px 16px', fontSize: '12px', fontWeight: 600, color: '#6b7280', textTransform: 'uppercase' }}>
                                                        Current Tab
                                                    </div>
                                                    {activeMainTab === 'scenes' && (
                                                        <>
                                                            <button
                                                                onClick={() => { exportScenesMarkdown(); setShowExportMenu(false); }}
                                                                style={{
                                                                    width: '100%',
                                                                    padding: '10px 16px',
                                                                    textAlign: 'left',
                                                                    border: 'none',
                                                                    background: 'none',
                                                                    cursor: 'pointer',
                                                                    fontSize: '14px',
                                                                    color: '#374151'
                                                                }}
                                                                onMouseEnter={(e) => e.target.style.backgroundColor = '#f3f4f6'}
                                                                onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                                            >
                                                                â†’ Scenes as Markdown
                                                            </button>
                                                            <button
                                                                onClick={() => { exportScenesCSV(); setShowExportMenu(false); }}
                                                                style={{
                                                                    width: '100%',
                                                                    padding: '10px 16px',
                                                                    textAlign: 'left',
                                                                    border: 'none',
                                                                    background: 'none',
                                                                    cursor: 'pointer',
                                                                    fontSize: '14px',
                                                                    color: '#374151'
                                                                }}
                                                                onMouseEnter={(e) => e.target.style.backgroundColor = '#f3f4f6'}
                                                                onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                                            >
                                                                â†’ Scenes as CSV
                                                            </button>
                                                        </>
                                                    )}
                                                    {activeMainTab === 'characters' && (
                                                        <>
                                                            <button
                                                                onClick={() => { exportCharactersMarkdown(); setShowExportMenu(false); }}
                                                                style={{
                                                                    width: '100%',
                                                                    padding: '10px 16px',
                                                                    textAlign: 'left',
                                                                    border: 'none',
                                                                    background: 'none',
                                                                    cursor: 'pointer',
                                                                    fontSize: '14px',
                                                                    color: '#374151'
                                                                }}
                                                                onMouseEnter={(e) => e.target.style.backgroundColor = '#f3f4f6'}
                                                                onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                                            >
                                                                â†’ Characters as Markdown
                                                            </button>
                                                            <button
                                                                onClick={() => { exportCharactersCSV(); setShowExportMenu(false); }}
                                                                style={{
                                                                    width: '100%',
                                                                    padding: '10px 16px',
                                                                    textAlign: 'left',
                                                                    border: 'none',
                                                                    background: 'none',
                                                                    cursor: 'pointer',
                                                                    fontSize: '14px',
                                                                    color: '#374151'
                                                                }}
                                                                onMouseEnter={(e) => e.target.style.backgroundColor = '#f3f4f6'}
                                                                onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                                            >
                                                                â†’ Characters as CSV
                                                            </button>
                                                        </>
                                                    )}
                                                    {activeMainTab === 'locations' && (
                                                        <>
                                                            <button
                                                                onClick={() => { exportLocationsMarkdown(); setShowExportMenu(false); }}
                                                                style={{
                                                                    width: '100%',
                                                                    padding: '10px 16px',
                                                                    textAlign: 'left',
                                                                    border: 'none',
                                                                    background: 'none',
                                                                    cursor: 'pointer',
                                                                    fontSize: '14px',
                                                                    color: '#374151'
                                                                }}
                                                                onMouseEnter={(e) => e.target.style.backgroundColor = '#f3f4f6'}
                                                                onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                                            >
                                                                â†’ Locations as Markdown
                                                            </button>
                                                            <button
                                                                onClick={() => { exportLocationsCSV(); setShowExportMenu(false); }}
                                                                style={{
                                                                    width: '100%',
                                                                    padding: '10px 16px',
                                                                    textAlign: 'left',
                                                                    border: 'none',
                                                                    background: 'none',
                                                                    cursor: 'pointer',
                                                                    fontSize: '14px',
                                                                    color: '#374151'
                                                                }}
                                                                onMouseEnter={(e) => e.target.style.backgroundColor = '#f3f4f6'}
                                                                onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                                            >
                                                                â†’ Locations as CSV
                                                            </button>
                                                        </>
                                                    )}
                                                    {activeMainTab === 'notes' && (
                                                        <>
                                                            <button
                                                                onClick={() => { exportNotesMarkdown(); setShowExportMenu(false); }}
                                                                style={{
                                                                    width: '100%',
                                                                    padding: '10px 16px',
                                                                    textAlign: 'left',
                                                                    border: 'none',
                                                                    background: 'none',
                                                                    cursor: 'pointer',
                                                                    fontSize: '14px',
                                                                    color: '#374151'
                                                                }}
                                                                onMouseEnter={(e) => e.target.style.backgroundColor = '#f3f4f6'}
                                                                onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                                            >
                                                                â†’ Notes as Markdown
                                                            </button>
                                                            <button
                                                                onClick={() => { exportNotesCSV(); setShowExportMenu(false); }}
                                                                style={{
                                                                    width: '100%',
                                                                    padding: '10px 16px',
                                                                    textAlign: 'left',
                                                                    border: 'none',
                                                                    background: 'none',
                                                                    cursor: 'pointer',
                                                                    fontSize: '14px',
                                                                    color: '#374151'
                                                                }}
                                                                onMouseEnter={(e) => e.target.style.backgroundColor = '#f3f4f6'}
                                                                onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                                            >
                                                                â†’ Notes as CSV
                                                            </button>
                                                        </>
                                                    )}
                                                    <div style={{ borderTop: '1px solid #e5e7eb', margin: '8px 0' }}></div>
                                                    <div style={{ padding: '8px 16px', fontSize: '12px', fontWeight: 600, color: '#6b7280', textTransform: 'uppercase' }}>
                                                        Full Project
                                                    </div>
                                                    <button
                                                        onClick={() => { exportFullProjectMarkdown(); setShowExportMenu(false); }}
                                                        style={{
                                                            width: '100%',
                                                            padding: '10px 16px',
                                                            textAlign: 'left',
                                                            border: 'none',
                                                            background: 'none',
                                                            cursor: 'pointer',
                                                            fontSize: '14px',
                                                            color: '#374151'
                                                        }}
                                                        onMouseEnter={(e) => e.target.style.backgroundColor = '#f3f4f6'}
                                                        onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                                    >
                                                        â†’ Full Markdown
                                                    </button>
                                                    <button
                                                        onClick={() => { exportFullProjectHTML(); setShowExportMenu(false); }}
                                                        style={{
                                                            width: '100%',
                                                            padding: '10px 16px',
                                                            textAlign: 'left',
                                                            border: 'none',
                                                            background: 'none',
                                                            cursor: 'pointer',
                                                            fontSize: '14px',
                                                            color: '#374151',
                                                            fontWeight: 600
                                                        }}
                                                        onMouseEnter={(e) => e.target.style.backgroundColor = '#f3f4f6'}
                                                        onMouseLeave={(e) => e.target.style.backgroundColor = 'transparent'}
                                                    >
                                                        â†’ Full HTML Report
                                                    </button>
                                                </div>
                                            )}
                                        </div>
                                    </>
                                )}
                                
                                {/* Help Button */}
                                <button
                                    onClick={() => setShowAbout(true)}
                                    className="btn btn-secondary"
                                    style={{
                                        width: '32px',
                                        height: '32px',
                                        padding: '0',
                                        fontSize: '16px',
                                        borderRadius: '50%',
                                        display: 'flex',
                                        alignItems: 'center',
                                        justifyContent: 'center'
                                    }}
                                    title="Help & About"
                                >
                                    ?
                                </button>
                            </div>
                        </div>
                    </header>

                    <input
                        ref={fileInputRef}
                        type="file"
                        accept=".novelatta,.json"
                        onChange={openProject}
                        className="hidden"
                    />

                    {/* New Project Modal */}
                    {showNewProject && (
                        <div className="modal-overlay">
                            <div className="modal">
                                <h2 className="modal-title">Create New Project</h2>
                                <input
                                    type="text"
                                    placeholder="Project name"
                                    value={newProjectName}
                                    onChange={(e) => setNewProjectName(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && createProject()}
                                    autoFocus
                                />
                                <div className="modal-buttons">
                                    <button
                                        onClick={createProject}
                                        className="btn btn-primary flex-1"
                                    >
                                        Create
                                    </button>
                                    <button
                                        onClick={() => {
                                            setShowNewProject(false);
                                            setNewProjectName('');
                                        }}
                                        className="btn btn-gray flex-1"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* Save As Modal */}
                    {showSaveAs && (
                        <div className="modal-overlay">
                            <div className="modal">
                                <h2 className="modal-title">Save Project As...</h2>
                                <p style={{ fontSize: '14px', color: '#6b7280', marginBottom: '12px' }}>
                                    Choose a filename for your project
                                </p>
                                <input
                                    type="text"
                                    placeholder="Filename"
                                    value={saveFileName}
                                    onChange={(e) => setSaveFileName(e.target.value)}
                                    onKeyPress={(e) => e.key === 'Enter' && performSave()}
                                    autoFocus
                                />
                                <p style={{ fontSize: '12px', color: '#9ca3af', marginTop: '8px' }}>
                                    .novelatta extension will be added automatically
                                </p>
                                <div className="modal-buttons">
                                    <button
                                        onClick={performSave}
                                        className="btn btn-primary flex-1"
                                    >
                                        ðŸ’¾ Save
                                    </button>
                                    <button
                                        onClick={() => {
                                            setShowSaveAs(false);
                                            setSaveFileName('');
                                        }}
                                        className="btn btn-gray flex-1"
                                    >
                                        Cancel
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {/* First-Time Save Notice Modal */}
                    {showFirstSaveNotice && (
                        <div className="modal-overlay">
                            <div className="modal" style={{ maxWidth: '480px' }}>
                                <div style={{ textAlign: 'center', marginBottom: '24px' }}>
                                    <div style={{ fontSize: '48px', marginBottom: '12px' }}>ðŸ’¾</div>
                                    <h2 className="modal-title" style={{ marginBottom: '8px' }}>About Saving Your Project</h2>
                                </div>
                                
                                <div style={{ 
                                    backgroundColor: '#f9fafb', 
                                    padding: '16px', 
                                    borderRadius: '8px',
                                    marginBottom: '20px',
                                    fontSize: '14px',
                                    lineHeight: '1.6',
                                    color: '#374151'
                                }}>
                                    <p style={{ marginBottom: '12px' }}>
                                        Each time you save, a <strong>new file downloads</strong> to your Downloads folder.
                                    </p>
                                    
                                    <div style={{ 
                                        display: 'flex', 
                                        alignItems: 'center', 
                                        gap: '8px',
                                        padding: '12px',
                                        backgroundColor: 'white',
                                        borderRadius: '6px',
                                        marginBottom: '12px',
                                        border: '1px solid #e5e7eb'
                                    }}>
                                        <span style={{ fontSize: '20px' }}>ðŸ“„</span>
                                        <span style={{ fontFamily: 'monospace', color: '#4f46e5', fontWeight: 600 }}>
                                            {currentProject?.name || 'MyProject'}.novelatta
                                        </span>
                                    </div>
                                    
                                    <p style={{ marginBottom: '12px' }}>
                                        If you save multiple times, your browser will add numbers:
                                    </p>
                                    
                                    <ul style={{ 
                                        margin: '0 0 12px 20px', 
                                        padding: 0,
                                        color: '#6b7280',
                                        fontSize: '13px',
                                        fontFamily: 'monospace'
                                    }}>
                                        <li>{currentProject?.name || 'MyProject'}.novelatta</li>
                                        <li>{currentProject?.name || 'MyProject'} (1).novelatta</li>
                                        <li>{currentProject?.name || 'MyProject'} (2).novelatta</li>
                                    </ul>
                                    
                                    <div style={{
                                        display: 'flex',
                                        gap: '8px',
                                        padding: '12px',
                                        backgroundColor: '#fef3c7',
                                        borderRadius: '6px',
                                        border: '1px solid #fbbf24'
                                    }}>
                                        <span style={{ fontSize: '16px' }}>ðŸ’¡</span>
                                        <div style={{ fontSize: '13px', color: '#78350f' }}>
                                            <strong>Tip:</strong> Delete old numbered versions to keep your Downloads folder organized.
                                        </div>
                                    </div>
                                </div>
                                
                                
                                <button
                                    onClick={proceedWithSave}
                                    className="btn btn-primary"
                                    style={{
                                        width: '100%',
                                        padding: '12px',
                                        fontSize: '16px'
                                    }}
                                >
                                    Got it!
                                </button>
                            </div>
                        </div>
                    )}

                    {/* About Modal */}
                    {showAbout && (
                        <div className="modal-overlay" onClick={() => { setShowAbout(false); setAboutTab('quickstart'); }}>
                            <div className="modal" onClick={(e) => e.stopPropagation()} style={{ maxWidth: '600px' }}>
                                <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '20px' }}>
                                    <div>
                                        <h2 className="modal-title" style={{ marginBottom: '4px' }}>Novelatta</h2>
                                        <p style={{ fontSize: '13px', color: '#6b7280', margin: 0 }}>Your complete story planning workspace</p>
                                    </div>
                                    <button className="close-btn" onClick={() => { setShowAbout(false); setAboutTab('quickstart'); }}>
                                        Ã—
                                    </button>
                                </div>
                                
                                <div style={{ 
                                    borderBottom: '2px solid #e5e7eb', 
                                    marginBottom: '20px',
                                    display: 'flex',
                                    gap: '16px',
                                    flexWrap: 'wrap'
                                }}>
                                    <div 
                                        onClick={() => setAboutTab('quickstart')}
                                        style={{
                                            paddingBottom: '10px',
                                            borderBottom: aboutTab === 'quickstart' ? '2px solid #4f46e5' : '2px solid transparent',
                                            marginBottom: '-2px',
                                            color: aboutTab === 'quickstart' ? '#4f46e5' : '#6b7280',
                                            fontWeight: 600,
                                            fontSize: '14px',
                                            cursor: 'pointer'
                                        }}
                                    >
                                        Quick Start
                                    </div>
                                    <div 
                                        onClick={() => setAboutTab('scenes')}
                                        style={{
                                            paddingBottom: '10px',
                                            borderBottom: aboutTab === 'scenes' ? '2px solid #4f46e5' : '2px solid transparent',
                                            marginBottom: '-2px',
                                            color: aboutTab === 'scenes' ? '#4f46e5' : '#6b7280',
                                            fontWeight: 600,
                                            fontSize: '14px',
                                            cursor: 'pointer'
                                        }}
                                    >
                                        Scenes
                                    </div>
                                    <div 
                                        onClick={() => setAboutTab('characters')}
                                        style={{
                                            paddingBottom: '10px',
                                            borderBottom: aboutTab === 'characters' ? '2px solid #4f46e5' : '2px solid transparent',
                                            marginBottom: '-2px',
                                            color: aboutTab === 'characters' ? '#4f46e5' : '#6b7280',
                                            fontWeight: 600,
                                            fontSize: '14px',
                                            cursor: 'pointer'
                                        }}
                                    >
                                        Characters
                                    </div>
                                    <div 
                                        onClick={() => setAboutTab('locations')}
                                        style={{
                                            paddingBottom: '10px',
                                            borderBottom: aboutTab === 'locations' ? '2px solid #4f46e5' : '2px solid transparent',
                                            marginBottom: '-2px',
                                            color: aboutTab === 'locations' ? '#4f46e5' : '#6b7280',
                                            fontWeight: 600,
                                            fontSize: '14px',
                                            cursor: 'pointer'
                                        }}
                                    >
                                        Locations
                                    </div>
                                    <div 
                                        onClick={() => setAboutTab('notes')}
                                        style={{
                                            paddingBottom: '10px',
                                            borderBottom: aboutTab === 'notes' ? '2px solid #4f46e5' : '2px solid transparent',
                                            marginBottom: '-2px',
                                            color: aboutTab === 'notes' ? '#4f46e5' : '#6b7280',
                                            fontWeight: 600,
                                            fontSize: '14px',
                                            cursor: 'pointer'
                                        }}
                                    >
                                        Notes
                                    </div>
                                    <div 
                                        onClick={() => setAboutTab('saving')}
                                        style={{
                                            paddingBottom: '10px',
                                            borderBottom: aboutTab === 'saving' ? '2px solid #4f46e5' : '2px solid transparent',
                                            marginBottom: '-2px',
                                            color: aboutTab === 'saving' ? '#4f46e5' : '#6b7280',
                                            fontWeight: 600,
                                            fontSize: '14px',
                                            cursor: 'pointer'
                                        }}
                                    >
                                        Saving & Files
                                    </div>
                                    <div 
                                        onClick={() => setAboutTab('credits')}
                                        style={{
                                            paddingBottom: '10px',
                                            borderBottom: aboutTab === 'credits' ? '2px solid #4f46e5' : '2px solid transparent',
                                            marginBottom: '-2px',
                                            color: aboutTab === 'credits' ? '#4f46e5' : '#6b7280',
                                            fontWeight: 600,
                                            fontSize: '14px',
                                            cursor: 'pointer'
                                        }}
                                    >
                                        Credits
                                    </div>
                                </div>

                                {aboutTab === 'quickstart' && (
                                    <div style={{ 
                                        padding: '10px 0',
                                        lineHeight: '1.7',
                                        color: '#374151',
                                        fontSize: '14px',
                                        maxHeight: '400px',
                                        overflowY: 'auto'
                                    }}>
                                        <h3 style={{ fontSize: '16px', fontWeight: 600, marginBottom: '16px', color: '#4f46e5' }}>
                                            ðŸš€ Getting Started
                                        </h3>
                                        
                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>What is Novelatta?</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                Novelatta is a complete story planning workspace that helps you organize your novel, screenplay, or narrative project. Track scenes, characters, locations, and notes all in one place.
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>1. Create a Project</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px' }}>
                                                Click "+ New Project" to begin
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>2. Use the Four Tabs</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px' }}>
                                                â€¢ <strong>Scenes:</strong> Plan your story with 4-act structure<br/>
                                                â€¢ <strong>Characters:</strong> Track your cast and their arcs<br/>
                                                â€¢ <strong>Locations:</strong> Build your world and settings<br/>
                                                â€¢ <strong>Notes:</strong> Capture ideas and research
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>3. Switch Between Views</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px' }}>
                                                Use Cards for visual overview or List for detailed table view
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>4. Save Your Work</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px' }}>
                                                Click "ðŸ’¾ Save Project..." to download<br/>
                                                Everything saves in one .novelatta file
                                            </div>
                                        </div>

                                        <div style={{ 
                                            marginTop: '20px', 
                                            padding: '12px', 
                                            backgroundColor: '#f0f9ff', 
                                            borderLeft: '3px solid #3b82f6',
                                            fontSize: '13px',
                                            borderRadius: '4px'
                                        }}>
                                            <strong style={{ color: '#1e40af' }}>ðŸ’¡ Tip:</strong> Click the tabs above to learn more about Scenes, Characters, Locations, and Notes!
                                        </div>
                                    </div>
                                )}

                                {aboutTab === 'scenes' && (
                                    <div style={{ 
                                        padding: '10px 0',
                                        lineHeight: '1.7',
                                        color: '#374151',
                                        fontSize: '14px',
                                        maxHeight: '400px',
                                        overflowY: 'auto'
                                    }}>
                                        <h3 style={{ fontSize: '16px', fontWeight: 600, marginBottom: '16px', color: '#4f46e5' }}>
                                            ðŸŽ¬ Understanding Scenes
                                        </h3>
                                        
                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>4-Act Structure</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                â€¢ <strong>Act 1:</strong> Setup and inciting incident<br/>
                                                â€¢ <strong>Act 2:</strong> Reactive, try old solutions<br/>
                                                â€¢ <strong>Act 3:</strong> Proactive, try new approach<br/>
                                                â€¢ <strong>Act 4:</strong> Climax and resolution
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>Action Scenes</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                Drive the plot forward with external conflict:<br/>
                                                â€¢ <strong>Objective:</strong> What does the character want?<br/>
                                                â€¢ <strong>Obstacle:</strong> What stands in their way?<br/>
                                                â€¢ <strong>Outcome:</strong> Success or failure?
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>Reaction Scenes</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                Process the consequences with internal reflection:<br/>
                                                â€¢ <strong>Emotion:</strong> How does the character feel?<br/>
                                                â€¢ <strong>Deliberation:</strong> What are their options?<br/>
                                                â€¢ <strong>Decision:</strong> What will they do next?
                                            </div>
                                        </div>

                                        <div style={{ 
                                            marginBottom: '16px',
                                            padding: '10px', 
                                            backgroundColor: '#eff6ff', 
                                            borderLeft: '3px solid #4f46e5',
                                            fontSize: '13px',
                                            borderRadius: '4px'
                                        }}>
                                            <strong style={{ color: '#1e40af' }}>â„¹ï¸ Note:</strong> Each scene must be <em>either</em> Action <em>or</em> Reaction. Switching types will clear the other type's fields.
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>Organizing with Chapters</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                â€¢ Click "+ Chapter" to create chapter groups<br/>
                                                â€¢ Drag scenes into chapters to organize<br/>
                                                â€¢ Chapters are numbered globally (1, 2, 3...)<br/>
                                                â€¢ Click the pencil icon (âœï¸) to rename chapters
                                            </div>
                                        </div>

                                        <div style={{ 
                                            marginTop: '20px', 
                                            padding: '12px', 
                                            backgroundColor: '#fef3c7', 
                                            borderLeft: '3px solid #f59e0b',
                                            fontSize: '13px',
                                            borderRadius: '4px'
                                        }}>
                                            <strong style={{ color: '#92400e' }}>ðŸ’¡ Best Practice:</strong> Alternate between Action and Reaction scenes to maintain rhythm and pacing
                                        </div>
                                    </div>
                                )}

                                {aboutTab === 'characters' && (
                                    <div style={{ 
                                        padding: '10px 0',
                                        lineHeight: '1.7',
                                        color: '#374151',
                                        fontSize: '14px',
                                        maxHeight: '400px',
                                        overflowY: 'auto'
                                    }}>
                                        <h3 style={{ fontSize: '16px', fontWeight: 600, marginBottom: '16px', color: '#4f46e5' }}>
                                            ðŸ‘¥ Tracking Characters
                                        </h3>
                                        
                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>Character Types</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                â€¢ <strong>Protagonist:</strong> Main character whose journey drives the story<br/>
                                                â€¢ <strong>Antagonist:</strong> Character who opposes the protagonist<br/>
                                                â€¢ <strong>Supporting:</strong> Important secondary characters<br/>
                                                â€¢ <strong>Minor:</strong> Background characters with smaller roles
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>Key Fields</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                â€¢ <strong>Role:</strong> Function in story (mentor, love interest, etc.)<br/>
                                                â€¢ <strong>Description:</strong> Physical appearance and traits<br/>
                                                â€¢ <strong>Personality:</strong> Behavioral patterns and quirks<br/>
                                                â€¢ <strong>Backstory:</strong> History that shapes who they are<br/>
                                                â€¢ <strong>Character Arc:</strong> How they change over the story<br/>
                                                â€¢ <strong>Relationships:</strong> Connections to other characters
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>Character Arc</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                Track how your character transforms:<br/>
                                                â€¢ What do they believe at the start?<br/>
                                                â€¢ What challenges force them to change?<br/>
                                                â€¢ Who are they by the end?
                                            </div>
                                        </div>

                                        <div style={{ 
                                            marginTop: '20px', 
                                            padding: '12px', 
                                            backgroundColor: '#fef3c7', 
                                            borderLeft: '3px solid #f59e0b',
                                            fontSize: '13px',
                                            borderRadius: '4px'
                                        }}>
                                            <strong style={{ color: '#92400e' }}>ðŸ’¡ Tip:</strong> Use First Appearance to track when each character enters the story
                                        </div>
                                    </div>
                                )}

                                {aboutTab === 'locations' && (
                                    <div style={{ 
                                        padding: '10px 0',
                                        lineHeight: '1.7',
                                        color: '#374151',
                                        fontSize: '14px',
                                        maxHeight: '400px',
                                        overflowY: 'auto'
                                    }}>
                                        <h3 style={{ fontSize: '16px', fontWeight: 600, marginBottom: '16px', color: '#4f46e5' }}>
                                            ðŸ—ºï¸ Building Your World
                                        </h3>
                                        
                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>Location Types</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                â€¢ <strong>City:</strong> Towns, cities, settlements<br/>
                                                â€¢ <strong>Building:</strong> Specific structures and facilities<br/>
                                                â€¢ <strong>Room:</strong> Interior spaces and chambers<br/>
                                                â€¢ <strong>Landscape:</strong> Natural settings and terrain<br/>
                                                â€¢ <strong>Other:</strong> Unique or fantastical locations
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>Description Tips</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                Use sensory details to make locations vivid:<br/>
                                                â€¢ What does it look like? (Visual)<br/>
                                                â€¢ What sounds fill the space? (Auditory)<br/>
                                                â€¢ What smells are present? (Olfactory)<br/>
                                                â€¢ How does it feel? (Tactile)<br/>
                                                â€¢ What's the atmosphere? (Emotional)
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>Story Significance</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                Why does this location matter?<br/>
                                                â€¢ Is it a setting for key scenes?<br/>
                                                â€¢ Does it symbolize themes?<br/>
                                                â€¢ How does it affect characters?<br/>
                                                â€¢ What events happen here?
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>Associated Characters</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                Track which characters frequent or own this location to maintain consistency
                                            </div>
                                        </div>

                                        <div style={{ 
                                            marginTop: '20px', 
                                            padding: '12px', 
                                            backgroundColor: '#fef3c7', 
                                            borderLeft: '3px solid #f59e0b',
                                            fontSize: '13px',
                                            borderRadius: '4px'
                                        }}>
                                            <strong style={{ color: '#92400e' }}>ðŸ’¡ Tip:</strong> Color-code locations by importance or by region in your world
                                        </div>
                                    </div>
                                )}

                                {aboutTab === 'notes' && (
                                    <div style={{ 
                                        padding: '10px 0',
                                        lineHeight: '1.7',
                                        color: '#374151',
                                        fontSize: '14px',
                                        maxHeight: '400px',
                                        overflowY: 'auto'
                                    }}>
                                        <h3 style={{ fontSize: '16px', fontWeight: 600, marginBottom: '16px', color: '#4f46e5' }}>
                                            ðŸ“ Capturing Ideas
                                        </h3>
                                        
                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>When to Use Notes</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                Notes are perfect for:<br/>
                                                â€¢ <strong>Plot Ideas:</strong> Twists and developments you're exploring<br/>
                                                â€¢ <strong>Research:</strong> Facts, references, and worldbuilding details<br/>
                                                â€¢ <strong>Themes:</strong> Symbolism and deeper meanings to track<br/>
                                                â€¢ <strong>Timeline:</strong> Chronology and event sequencing<br/>
                                                â€¢ <strong>Writing Reminders:</strong> Things to fix or develop later<br/>
                                                â€¢ <strong>Brainstorming:</strong> Raw ideas that don't fit elsewhere yet
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>Notes vs Other Tabs</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                â€¢ Use <strong>Scenes</strong> for structured story beats<br/>
                                                â€¢ Use <strong>Characters</strong> for detailed character profiles<br/>
                                                â€¢ Use <strong>Locations</strong> for specific places<br/>
                                                â€¢ Use <strong>Notes</strong> for everything else!
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>Pinning Important Notes</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                Click the ðŸ“Œ checkbox to pin critical notes to the top. Great for:<br/>
                                                â€¢ Core themes to remember<br/>
                                                â€¢ Important plot points to plant<br/>
                                                â€¢ Urgent items that need attention
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '16px' }}>
                                            <strong>Color Coding</strong>
                                            <div style={{ marginLeft: '20px', color: '#6b7280', fontSize: '13px', marginTop: '4px' }}>
                                                Use colors to organize notes by type:<br/>
                                                â€¢ Red for urgent items or problems<br/>
                                                â€¢ Yellow for ideas to develop<br/>
                                                â€¢ Green for completed research<br/>
                                                â€¢ Blue for worldbuilding details<br/>
                                                â€¢ Purple for themes and symbolism
                                            </div>
                                        </div>

                                        <div style={{ 
                                            marginTop: '20px', 
                                            padding: '12px', 
                                            backgroundColor: '#fef3c7', 
                                            borderLeft: '3px solid #f59e0b',
                                            fontSize: '13px',
                                            borderRadius: '4px'
                                        }}>
                                            <strong style={{ color: '#92400e' }}>ðŸ’¡ Pro Tip:</strong> Create a "Master Timeline" note to track all major events in chronological order
                                        </div>
                                    </div>
                                )}

                                {aboutTab === 'saving' && (
                                    <div style={{ 
                                        padding: '10px 0',
                                        lineHeight: '1.7',
                                        color: '#374151',
                                        fontSize: '14px'
                                    }}>
                                        <h3 style={{ fontSize: '16px', fontWeight: 600, marginBottom: '16px', color: '#1f2937' }}>
                                            How Saving Works
                                        </h3>

                                        <div style={{ marginBottom: '20px' }}>
                                            <h4 style={{ fontSize: '15px', fontWeight: 600, marginBottom: '8px', color: '#4f46e5' }}>
                                                ðŸ’¾ Quick Save Button
                                            </h4>
                                            <ul style={{ marginLeft: '20px', lineHeight: '1.8' }}>
                                                <li>Downloads a new <strong>.novelatta</strong> file each time</li>
                                                <li>File goes to your Downloads folder</li>
                                                <li>Browser adds numbers if file exists:</li>
                                            </ul>
                                            <div style={{ 
                                                marginLeft: '40px',
                                                marginTop: '8px',
                                                fontFamily: 'monospace',
                                                fontSize: '13px',
                                                color: '#6b7280',
                                                backgroundColor: '#f9fafb',
                                                padding: '12px',
                                                borderRadius: '6px',
                                                border: '1px solid #e5e7eb'
                                            }}>
                                                MyProject.novelatta<br/>
                                                MyProject (1).novelatta<br/>
                                                MyProject (2).novelatta
                                            </div>
                                        </div>

                                        <div style={{ marginBottom: '20px' }}>
                                            <h4 style={{ fontSize: '15px', fontWeight: 600, marginBottom: '8px', color: '#4f46e5' }}>
                                                ðŸ“‹ Best Practices
                                            </h4>
                                            <ol style={{ marginLeft: '20px', lineHeight: '1.8' }}>
                                                <li>Save frequently while working</li>
                                                <li>At end of session, delete old numbered versions</li>
                                                <li>Keep only the latest file</li>
                                                <li>Or keep multiple versions as backups if desired</li>
                                            </ol>
                                        </div>

                                        <div style={{ marginBottom: '20px' }}>
                                            <h4 style={{ fontSize: '15px', fontWeight: 600, marginBottom: '8px', color: '#4f46e5' }}>
                                                ðŸ’¾ Save As... (File Menu)
                                            </h4>
                                            <ul style={{ marginLeft: '20px', lineHeight: '1.8' }}>
                                                <li>Lets you rename before saving</li>
                                                <li>Creates a copy with new name</li>
                                                <li>Useful for creating variants</li>
                                                <li>Keyboard shortcut: <strong>Ctrl+Shift+S</strong></li>
                                            </ul>
                                        </div>

                                        <div style={{ marginBottom: '20px' }}>
                                            <h4 style={{ fontSize: '15px', fontWeight: 600, marginBottom: '8px', color: '#4f46e5' }}>
                                                â“ Why Downloads?
                                            </h4>
                                            <p style={{ marginLeft: '20px', marginBottom: '8px' }}>
                                                Web browsers cannot modify files on your computer for security reasons. Each save must create a new download.
                                            </p>
                                        </div>

                                        <div style={{
                                            backgroundColor: '#fef3c7',
                                            border: '1px solid #fbbf24',
                                            padding: '12px 16px',
                                            borderRadius: '6px',
                                            marginTop: '20px'
                                        }}>
                                            <strong style={{ color: '#92400e' }}>ðŸ’¡ File Management Tips:</strong>
                                            <ul style={{ marginLeft: '20px', marginTop: '8px', color: '#78350f', lineHeight: '1.8' }}>
                                                <li>Create a dedicated folder for your projects</li>
                                                <li>Move files from Downloads to project folder</li>
                                                <li>Delete old versions regularly</li>
                                                <li>Consider dated filenames: "MyNovel-2024-11-27.novelatta"</li>
                                            </ul>
                                        </div>
                                    </div>
                                )}

                                {aboutTab === 'credits' && (
                                    <div style={{ 
                                        textAlign: 'center',
                                        padding: '20px 0',
                                        lineHeight: '1.8',
                                        color: '#374151'
                                    }}>
                                        <p style={{ fontSize: '14px', marginBottom: '12px' }}>
                                            Created by <strong>Kevin Hwang</strong> with <strong>Claude</strong>
                                        </p>
                                        <p style={{ fontSize: '14px', marginBottom: '20px' }}>
                                            Nov 26, 2025
                                        </p>
                                        <p style={{ fontSize: '12px', color: '#6b7280', borderTop: '1px solid #e5e7eb', paddingTop: '16px' }}>
                                            Last Modified: {lastModified}
                                        </p>
                                        <p style={{ fontSize: '12px', color: '#6b7280', marginTop: '8px' }}>
                                            <a href="https://kevinhwang.com" target="_blank" rel="noopener noreferrer" style={{ color: '#4f46e5', textDecoration: 'none' }}>
                                                KevinHwang.com
                                            </a>
                                        </p>
                                    </div>
                                )}
                            </div>
                        </div>
                    )}

                    {/* Main Content */}
                    {!currentProject ? (
                        <div className="main-content">
                            <div className="empty-state">
                                <img src="data:image/webp;base64,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" alt="Novelatta Logo" style={{ width: '120px', height: '120px', marginBottom: '16px' }} />
                                <h2 className="empty-title">Welcome to Novelatta</h2>
                                <p className="empty-subtitle" style={{ marginBottom: '24px' }}>
                                    Your complete story planning workspace
                                </p>
                                
                                <div style={{ 
                                    textAlign: 'left', 
                                    maxWidth: '500px', 
                                    margin: '0 auto 32px',
                                    padding: '24px',
                                    backgroundColor: '#f9fafb',
                                    borderRadius: '8px',
                                    border: '1px solid #e5e7eb'
                                }}>
                                    <h3 style={{ 
                                        fontSize: '16px', 
                                        fontWeight: 600, 
                                        marginBottom: '16px',
                                        color: '#374151'
                                    }}>
                                        Plan your story with:
                                    </h3>
                                    <div style={{ 
                                        display: 'flex', 
                                        flexDirection: 'column', 
                                        gap: '12px',
                                        fontSize: '14px',
                                        color: '#6b7280'
                                    }}>
                                        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                            <span style={{ fontSize: '20px' }}>ðŸŽ¬</span>
                                            <span><strong style={{ color: '#374151' }}>4-Act Scene Structure</strong> â€” Plan with Action and Reaction scenes</span>
                                        </div>
                                        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                            <span style={{ fontSize: '20px' }}>ðŸ‘¥</span>
                                            <span><strong style={{ color: '#374151' }}>Character Tracking</strong> â€” Develop arcs and relationships</span>
                                        </div>
                                        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                            <span style={{ fontSize: '20px' }}>ðŸ—ºï¸</span>
                                            <span><strong style={{ color: '#374151' }}>Location Database</strong> â€” Build your world with rich details</span>
                                        </div>
                                        <div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}>
                                            <span style={{ fontSize: '20px' }}>ðŸ“</span>
                                            <span><strong style={{ color: '#374151' }}>Research Notes</strong> â€” Capture ideas and organize research</span>
                                        </div>
                                    </div>
                                </div>

                                <div style={{ display: 'flex', gap: '16px', justifyContent: 'center', flexWrap: 'wrap' }}>
                                    <button
                                        onClick={() => setShowNewProject(true)}
                                        className="btn"
                                        style={{ fontSize: '16px', padding: '12px 24px', backgroundColor: '#666699', color: 'white' }}
                                    >
                                        + Create New Project
                                    </button>
                                    <button
                                        onClick={handleOpenProject}
                                        className="btn"
                                        style={{ fontSize: '16px', padding: '12px 24px', backgroundColor: '#666699', color: 'white' }}
                                    >
                                        ðŸ“‚ Open Project
                                    </button>
                                </div>
                            </div>
                        </div>
                    ) : (
                        <>
                            {/* Main Tabs */}
                            <div className="main-tabs">
                                <div className="main-tabs-content">
                                    <button 
                                        className={`main-tab ${activeMainTab === 'scenes' ? 'active' : ''}`}
                                        onClick={() => {
                                            setActiveMainTab('scenes');
                                            setSearchQuery('');
                                        }}
                                    >
                                        Scenes ({scenes.length})
                                    </button>
                                    <button 
                                        className={`main-tab ${activeMainTab === 'characters' ? 'active' : ''}`}
                                        onClick={() => {
                                            setActiveMainTab('characters');
                                            setScenesSearchQuery('');
                                            setSearchQuery('');
                                        }}
                                    >
                                        Characters ({characters.length})
                                    </button>
                                    <button 
                                        className={`main-tab ${activeMainTab === 'locations' ? 'active' : ''}`}
                                        onClick={() => {
                                            setActiveMainTab('locations');
                                            setScenesSearchQuery('');
                                            setSearchQuery('');
                                        }}
                                    >
                                        Locations ({locations.length})
                                    </button>
                                    <button 
                                        className={`main-tab ${activeMainTab === 'notes' ? 'active' : ''}`}
                                        onClick={() => {
                                            setActiveMainTab('notes');
                                            setScenesSearchQuery('');
                                            setSearchQuery('');
                                        }}
                                    >
                                        Notes ({notes.length})
                                    </button>
                                </div>
                            </div>

                            {/* Sub-header for Characters and Locations */}
                            <main className="main-content">
                                {/* Scenes Tab */}
                                {activeMainTab === 'scenes' && (
                                    <>
                                        <div className="sub-header">
                                            <div className="sub-header-content" style={{ justifyContent: 'space-between' }}>
                                                <div style={{ display: 'flex', gap: '12px', alignItems: 'center', flex: 1 }}>
                                                    <input 
                                                        type="text"
                                                        className="search-input"
                                                        placeholder="Search scenes by title, objective, emotion, notes..."
                                                        value={scenesSearchQuery}
                                                        onChange={(e) => setScenesSearchQuery(e.target.value)}
                                                        style={{ maxWidth: '500px' }}
                                                    />
                                                    {scenesSearchQuery && (
                                                        <>
                                                            <span style={{ fontSize: '13px', color: '#6b7280' }}>
                                                                {getFilteredScenes().length} scene{getFilteredScenes().length !== 1 ? 's' : ''} match
                                                            </span>
                                                            <button
                                                                onClick={() => setScenesSearchQuery('')}
                                                                className="btn btn-small btn-gray"
                                                            >
                                                                Clear
                                                            </button>
                                                        </>
                                                    )}
                                                </div>
                                                <div className="tab-buttons">
                                                    <button 
                                                        className={`tab-btn ${scenesViewMode === 'card' ? 'active' : 'inactive'}`}
                                                        onClick={() => setScenesViewMode('card')}
                                                    >
                                                        Cards
                                                    </button>
                                                    <button 
                                                        className={`tab-btn ${scenesViewMode === 'list' ? 'active' : 'inactive'}`}
                                                        onClick={() => setScenesViewMode('list')}
                                                    >
                                                        List
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        {scenesViewMode === 'card' ? (
                                            <div className="acts-grid">
                                                {[1, 2, 3, 4].map(act => (
                                            <div key={act} className="act-column">
                                                <div className="act-header">
                                                    <h2 className="act-title">ACT {act}</h2>
                                                    <button
                                                        onClick={() => {
                                                            const name = prompt('Chapter name:');
                                                            if (name) addChapter(act, name);
                                                        }}
                                                        className="btn btn-small"
                                                        style={{ 
                                                            backgroundColor: 'white',
                                                            color: '#4f46e5',
                                                            fontWeight: 600
                                                        }}
                                                    >
                                                        + Chapter
                                                    </button>
                                                </div>

                                                <div className="scenes-container">
                                                    {/* Chapters */}
                                                    {getChaptersByAct(act).map((chapter) => (
                                                        <div key={chapter.id} className="chapter-container">
                                                            <div 
                                                                className="chapter-header"
                                                                onDragOver={(e) => handleSceneDragOver(e, chapter.id)}
                                                                onDragLeave={handleSceneDragLeave}
                                                                onDrop={(e) => handleSceneDrop(e, null, act, chapter.id)}
                                                                style={{
                                                                    backgroundColor: dragOverChapter === chapter.id ? '#eff6ff' : '#f3f4f6',
                                                                    borderColor: dragOverChapter === chapter.id ? '#3b82f6' : '#6366f1'
                                                                }}
                                                            >
                                                                <div 
                                                                    className="chapter-title"
                                                                    onClick={() => toggleChapterCollapse(chapter.id)}
                                                                    style={{ cursor: 'pointer', flex: 1 }}
                                                                >
                                                                    <span style={{
                                                                        fontSize: '12px',
                                                                        color: '#6b7280',
                                                                        transition: 'transform 0.2s ease',
                                                                        display: 'inline-block',
                                                                        transform: chapter.collapsed ? 'rotate(-90deg)' : 'rotate(0deg)'
                                                                    }}>
                                                                        â–¼
                                                                    </span>
                                                                    {editingChapter === chapter.id ? (
                                                                        <span>
                                                                            <span style={{ fontWeight: 600, marginRight: '4px' }}>
                                                                                Ch {getGlobalChapterNumber(chapter.id)}:
                                                                            </span>
                                                                            <input
                                                                                type="text"
                                                                                value={chapter.name}
                                                                                onChange={(e) => updateChapter(chapter.id, { name: e.target.value })}
                                                                                onBlur={() => setEditingChapter(null)}
                                                                                onKeyDown={(e) => {
                                                                                    if (e.key === 'Enter') setEditingChapter(null);
                                                                                    if (e.key === 'Escape') setEditingChapter(null);
                                                                                }}
                                                                                onClick={(e) => e.stopPropagation()}
                                                                                autoFocus
                                                                                style={{
                                                                                    border: 'none',
                                                                                    background: 'white',
                                                                                    padding: '2px 6px',
                                                                                    borderRadius: '3px',
                                                                                    fontSize: '14px',
                                                                                    fontWeight: 600,
                                                                                    width: '200px'
                                                                                }}
                                                                            />
                                                                        </span>
                                                                    ) : (
                                                                        <span style={{ display: 'flex', alignItems: 'center', gap: '8px' }}>
                                                                            <span>
                                                                                Ch {getGlobalChapterNumber(chapter.id)}: {chapter.name}
                                                                            </span>
                                                                            <button
                                                                                onClick={(e) => {
                                                                                    e.stopPropagation();
                                                                                    setEditingChapter(chapter.id);
                                                                                }}
                                                                                className="icon-btn"
                                                                                title="Rename chapter"
                                                                                style={{
                                                                                    fontSize: '14px',
                                                                                    padding: '2px 6px',
                                                                                    color: '#6b7280',
                                                                                    background: 'none',
                                                                                    border: 'none',
                                                                                    cursor: 'pointer',
                                                                                    transition: 'color 0.2s'
                                                                                }}
                                                                                onMouseEnter={(e) => e.target.style.color = '#4f46e5'}
                                                                                onMouseLeave={(e) => e.target.style.color = '#6b7280'}
                                                                            >
                                                                                âœï¸
                                                                            </button>
                                                                        </span>
                                                                    )}
                                                                    {chapter.collapsed && (
                                                                        <span style={{ fontWeight: 400, color: '#6b7280', fontSize: '13px' }}>
                                                                            ({getScenesByChapter(chapter.id).length} scenes)
                                                                        </span>
                                                                    )}
                                                                </div>
                                                                <div 
                                                                    style={{ display: 'flex', gap: '4px', alignItems: 'center' }}
                                                                    onClick={(e) => e.stopPropagation()}
                                                                >
                                                                    <button
                                                                        onClick={() => moveChapterUp(chapter.id)}
                                                                        disabled={isFirstChapter(chapter.id, act)}
                                                                        className="chapter-arrow-btn"
                                                                        title="Move chapter up"
                                                                    >
                                                                        â†‘
                                                                    </button>
                                                                    <button
                                                                        onClick={() => moveChapterDown(chapter.id)}
                                                                        disabled={isLastChapter(chapter.id, act)}
                                                                        className="chapter-arrow-btn"
                                                                        title="Move chapter down"
                                                                    >
                                                                        â†“
                                                                    </button>
                                                                    <button
                                                                        onClick={() => addScene(act, chapter.id)}
                                                                        className="btn btn-small"
                                                                        style={{ 
                                                                            padding: '4px 8px', 
                                                                            fontSize: '11px',
                                                                            backgroundColor: 'white',
                                                                            border: '1px solid #d1d5db'
                                                                        }}
                                                                    >
                                                                        + Scene
                                                                    </button>
                                                                    <button
                                                                        onClick={() => deleteChapter(chapter.id)}
                                                                        className="icon-btn delete"
                                                                        style={{ fontSize: '14px' }}
                                                                    >
                                                                        ðŸ—‘ï¸
                                                                    </button>
                                                                </div>
                                                            </div>
                                                            
                                                            {!chapter.collapsed && (
                                                                <div className="chapter-scenes">
                                                                    {getScenesByChapter(chapter.id).map(scene => (
                                                                        <SceneCard
                                                                            key={scene.id}
                                                                            scene={scene}
                                                                            isEditing={editingScene === scene.id}
                                                                            isDragging={draggedScene?.id === scene.id}
                                                                            onEdit={() => setEditingScene(scene.id)}
                                                                            onDone={() => setEditingScene(null)}
                                                                            onUpdate={(updates) => updateScene(scene.id, updates)}
                                                                            onDelete={() => deleteScene(scene.id)}
                                                                            onDragStart={handleSceneDragStart}
                                                                            onDragOver={handleSceneDragOver}
                                                                            onDrop={handleSceneDrop}
                                                                        />
                                                                    ))}
                                                                </div>
                                                            )}
                                                        </div>
                                                    ))}

                                                    {/* Unchaptered Scenes */}
                                                    {getUnchapteredScenes(act).length > 0 || draggedScene ? (
                                                        <div 
                                                            className="chapter-container"
                                                            style={{ marginTop: '16px' }}
                                                        >
                                                            <div 
                                                                className="chapter-header"
                                                                onDragOver={(e) => handleSceneDragOver(e, `unchaptered-${act}`)}
                                                                onDragLeave={handleSceneDragLeave}
                                                                onDrop={(e) => handleSceneDrop(e, null, act, null)}
                                                                style={{
                                                                    backgroundColor: dragOverChapter === `unchaptered-${act}` ? '#eff6ff' : '#f3f4f6',
                                                                    borderColor: dragOverChapter === `unchaptered-${act}` ? '#3b82f6' : '#6366f1',
                                                                    borderStyle: 'dashed'
                                                                }}
                                                            >
                                                                <div className="chapter-title">
                                                                    Unchaptered Scenes
                                                                </div>
                                                            </div>
                                                            <div style={{ display: 'flex', flexDirection: 'column', gap: '8px', marginTop: '8px' }}>
                                                                {getUnchapteredScenes(act).map(scene => (
                                                                    <SceneCard
                                                                        key={scene.id}
                                                                        scene={scene}
                                                                        isEditing={editingScene === scene.id}
                                                                        isDragging={draggedScene?.id === scene.id}
                                                                        onEdit={() => setEditingScene(scene.id)}
                                                                        onDone={() => setEditingScene(null)}
                                                                        onUpdate={(updates) => updateScene(scene.id, updates)}
                                                                        onDelete={() => deleteScene(scene.id)}
                                                                        onDragStart={handleSceneDragStart}
                                                                        onDragOver={handleSceneDragOver}
                                                                        onDrop={handleSceneDrop}
                                                                    />
                                                                ))}
                                                            </div>
                                                        </div>
                                                    ) : null}

                                                    {/* Add Scene Button */}
                                                    <button
                                                        onClick={() => addScene(act)}
                                                        className="btn btn-primary"
                                                        style={{ width: '100%', marginTop: '8px' }}
                                                    >
                                                        + Add Scene
                                                    </button>
                                                </div>
                                            </div>
                                        ))}
                                    </div>
                                        ) : (
                                            <ScenesList
                                                scenes={getScenesInOrder(getFilteredScenes())}
                                                chapters={chapters}
                                                expandedRow={expandedSceneRow}
                                                onToggleExpand={(id) => setExpandedSceneRow(expandedSceneRow === id ? null : id)}
                                                onEdit={(id) => {
                                                    setEditingScene(id);
                                                    setShowSceneModal(true);
                                                }}
                                                onDelete={deleteScene}
                                                getChapterNumber={getGlobalChapterNumber}
                                            />
                                        )}
                                    </>
                                )}

                                {/* Characters Tab */}
                                {activeMainTab === 'characters' && (
                                    <>
                                        <div className="sub-header">
                                            <div className="sub-header-content" style={{ justifyContent: 'space-between' }}>
                                                <div style={{ display: 'flex', gap: '12px', alignItems: 'center', flex: 1 }}>
                                                    <input 
                                                        type="text"
                                                        className="search-input"
                                                        placeholder="Search characters by name, type, role, description..."
                                                        value={searchQuery}
                                                        onChange={(e) => setSearchQuery(e.target.value)}
                                                        style={{ maxWidth: '500px' }}
                                                    />
                                                    {searchQuery && (
                                                        <>
                                                            <span style={{ fontSize: '13px', color: '#6b7280' }}>
                                                                {filteredCharacters.length} result{filteredCharacters.length !== 1 ? 's' : ''}
                                                            </span>
                                                            <button
                                                                onClick={() => setSearchQuery('')}
                                                                className="btn btn-small btn-gray"
                                                            >
                                                                Clear
                                                            </button>
                                                        </>
                                                    )}
                                                </div>
                                                <div className="tab-buttons">
                                                    <button 
                                                        className={`tab-btn ${viewMode === 'card' ? 'active' : 'inactive'}`}
                                                        onClick={() => setViewMode('card')}
                                                    >
                                                        Cards
                                                    </button>
                                                    <button 
                                                        className={`tab-btn ${viewMode === 'list' ? 'active' : 'inactive'}`}
                                                        onClick={() => setViewMode('list')}
                                                    >
                                                        List
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        {filteredCharacters.length === 0 ? (
                                            <div className="empty-state">
                                                <h2 className="empty-title">No Characters Yet</h2>
                                                <p className="empty-subtitle">
                                                    {searchQuery ? 'No characters match your search.' : 'Start building your story by adding your first character.'}
                                                </p>
                                                {!searchQuery && (
                                                    <button className="btn btn-primary" onClick={addCharacter}>
                                                        + Add Your First Character
                                                    </button>
                                                )}
                                            </div>
                                        ) : viewMode === 'card' ? (
                                            <div className="card-grid">
                                                {filteredCharacters.map(character => (
                                                    <CharacterCard
                                                        key={character.id}
                                                        character={character}
                                                        isExpanded={expandedCard === character.id}
                                                        isDragging={draggedCharacter?.id === character.id}
                                                        onToggleExpand={() => setExpandedCard(expandedCard === character.id ? null : character.id)}
                                                        onEdit={() => {
                                                            setEditingCard(character.id);
                                                            setShowModal(true);
                                                        }}
                                                        onDelete={() => deleteCharacter(character.id)}
                                                        onDragStart={handleCharacterDragStart}
                                                        onDragOver={handleCharacterDragOver}
                                                        onDrop={handleCharacterDrop}
                                                    />
                                                ))}
                                                <div 
                                                    className="add-card"
                                                    onClick={addCharacter}
                                                    style={{
                                                        border: '2px dashed #d1d5db',
                                                        borderRadius: '8px',
                                                        padding: '40px 20px',
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        justifyContent: 'center',
                                                        cursor: 'pointer',
                                                        backgroundColor: '#f9fafb',
                                                        transition: 'all 0.2s',
                                                        minHeight: '150px'
                                                    }}
                                                    onMouseEnter={(e) => {
                                                        e.currentTarget.style.borderColor = '#4f46e5';
                                                        e.currentTarget.style.backgroundColor = '#eff6ff';
                                                    }}
                                                    onMouseLeave={(e) => {
                                                        e.currentTarget.style.borderColor = '#d1d5db';
                                                        e.currentTarget.style.backgroundColor = '#f9fafb';
                                                    }}
                                                >
                                                    <span style={{ fontSize: '16px', color: '#6b7280', fontWeight: 500 }}>
                                                        + Add Character
                                                    </span>
                                                </div>
                                            </div>
                                        ) : (
                                            <CharacterList
                                                characters={filteredCharacters}
                                                draggedCharacter={draggedCharacter}
                                                onEdit={(id) => {
                                                    setEditingCard(id);
                                                    setShowModal(true);
                                                }}
                                                onDelete={deleteCharacter}
                                                onDragStart={handleCharacterDragStart}
                                                onDragOver={handleCharacterDragOver}
                                                onDrop={handleCharacterDrop}
                                            />
                                        )}
                                    </>
                                )}

                                {/* Locations Tab */}
                                {activeMainTab === 'locations' && (
                                    <>
                                        <div className="sub-header">
                                            <div className="sub-header-content" style={{ justifyContent: 'space-between' }}>
                                                <div style={{ display: 'flex', gap: '12px', alignItems: 'center', flex: 1 }}>
                                                    <input 
                                                        type="text"
                                                        className="search-input"
                                                        placeholder="Search locations by name, type, description..."
                                                        value={searchQuery}
                                                        onChange={(e) => setSearchQuery(e.target.value)}
                                                        style={{ maxWidth: '500px' }}
                                                    />
                                                    {searchQuery && (
                                                        <>
                                                            <span style={{ fontSize: '13px', color: '#6b7280' }}>
                                                                {filteredLocations.length} result{filteredLocations.length !== 1 ? 's' : ''}
                                                            </span>
                                                            <button
                                                                onClick={() => setSearchQuery('')}
                                                                className="btn btn-small btn-gray"
                                                            >
                                                                Clear
                                                            </button>
                                                        </>
                                                    )}
                                                </div>
                                                <div className="tab-buttons">
                                                    <button 
                                                        className={`tab-btn ${viewMode === 'card' ? 'active' : 'inactive'}`}
                                                        onClick={() => setViewMode('card')}
                                                    >
                                                        Cards
                                                    </button>
                                                    <button 
                                                        className={`tab-btn ${viewMode === 'list' ? 'active' : 'inactive'}`}
                                                        onClick={() => setViewMode('list')}
                                                    >
                                                        List
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        {filteredLocations.length === 0 ? (
                                            <div className="empty-state">
                                                <h2 className="empty-title">No Locations Yet</h2>
                                                <p className="empty-subtitle">
                                                    {searchQuery ? 'No locations match your search.' : 'Start building your world by adding your first location.'}
                                                </p>
                                                {!searchQuery && (
                                                    <button className="btn btn-primary" onClick={addLocation}>
                                                        + Add Your First Location
                                                    </button>
                                                )}
                                            </div>
                                        ) : viewMode === 'card' ? (
                                            <div className="card-grid">
                                                {filteredLocations.map(location => (
                                                    <LocationCard
                                                        key={location.id}
                                                        location={location}
                                                        isExpanded={expandedCard === location.id}
                                                        isDragging={draggedLocation?.id === location.id}
                                                        onToggleExpand={() => setExpandedCard(expandedCard === location.id ? null : location.id)}
                                                        onEdit={() => {
                                                            setEditingCard(location.id);
                                                            setShowModal(true);
                                                        }}
                                                        onDelete={() => deleteLocation(location.id)}
                                                        onDragStart={handleLocationDragStart}
                                                        onDragOver={handleLocationDragOver}
                                                        onDrop={handleLocationDrop}
                                                    />
                                                ))}
                                                <div 
                                                    className="add-card"
                                                    onClick={addLocation}
                                                    style={{
                                                        border: '2px dashed #d1d5db',
                                                        borderRadius: '8px',
                                                        padding: '40px 20px',
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        justifyContent: 'center',
                                                        cursor: 'pointer',
                                                        backgroundColor: '#f9fafb',
                                                        transition: 'all 0.2s',
                                                        minHeight: '150px'
                                                    }}
                                                    onMouseEnter={(e) => {
                                                        e.currentTarget.style.borderColor = '#4f46e5';
                                                        e.currentTarget.style.backgroundColor = '#eff6ff';
                                                    }}
                                                    onMouseLeave={(e) => {
                                                        e.currentTarget.style.borderColor = '#d1d5db';
                                                        e.currentTarget.style.backgroundColor = '#f9fafb';
                                                    }}
                                                >
                                                    <span style={{ fontSize: '16px', color: '#6b7280', fontWeight: 500 }}>
                                                        + Add Location
                                                    </span>
                                                </div>
                                            </div>
                                        ) : (
                                            <LocationList
                                                locations={filteredLocations}
                                                draggedLocation={draggedLocation}
                                                onEdit={(id) => {
                                                    setEditingCard(id);
                                                    setShowModal(true);
                                                }}
                                                onDelete={deleteLocation}
                                                onDragStart={handleLocationDragStart}
                                                onDragOver={handleLocationDragOver}
                                                onDrop={handleLocationDrop}
                                            />
                                        )}
                                    </>
                                )}

                                {/* Notes Tab */}
                                {activeMainTab === 'notes' && (
                                    <>
                                        <div className="sub-header">
                                            <div className="sub-header-content" style={{ justifyContent: 'space-between' }}>
                                                <div style={{ display: 'flex', gap: '12px', alignItems: 'center', flex: 1 }}>
                                                    <input 
                                                        type="text"
                                                        className="search-input"
                                                        placeholder="Search notes by title, content..."
                                                        value={searchQuery}
                                                        onChange={(e) => setSearchQuery(e.target.value)}
                                                        style={{ maxWidth: '500px' }}
                                                    />
                                                    {searchQuery && (
                                                        <>
                                                            <span style={{ fontSize: '13px', color: '#6b7280' }}>
                                                                {filteredNotes.length} result{filteredNotes.length !== 1 ? 's' : ''}
                                                            </span>
                                                            <button
                                                                onClick={() => setSearchQuery('')}
                                                                className="btn btn-small btn-gray"
                                                            >
                                                                Clear
                                                            </button>
                                                        </>
                                                    )}
                                                </div>
                                                <div className="tab-buttons">
                                                    <button 
                                                        className={`tab-btn ${viewMode === 'card' ? 'active' : 'inactive'}`}
                                                        onClick={() => setViewMode('card')}
                                                    >
                                                        Cards
                                                    </button>
                                                    <button 
                                                        className={`tab-btn ${viewMode === 'list' ? 'active' : 'inactive'}`}
                                                        onClick={() => setViewMode('list')}
                                                    >
                                                        List
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        {filteredNotes.length === 0 ? (
                                            <div className="empty-state">
                                                <h2 className="empty-title">No Notes Yet</h2>
                                                <p className="empty-subtitle">
                                                    {searchQuery ? 'No notes match your search.' : 'Start capturing your story ideas and research.'}
                                                </p>
                                                {!searchQuery && (
                                                    <button className="btn btn-primary" onClick={addNote}>
                                                        + Add Your First Note
                                                    </button>
                                                )}
                                            </div>
                                        ) : viewMode === 'card' ? (
                                            <div className="card-grid">
                                                {filteredNotes.map(note => (
                                                    <NoteCard
                                                        key={note.id}
                                                        note={note}
                                                        isExpanded={expandedCard === note.id}
                                                        onToggleExpand={() => setExpandedCard(expandedCard === note.id ? null : note.id)}
                                                        onEdit={() => {
                                                            setEditingCard(note.id);
                                                            setShowModal(true);
                                                        }}
                                                        onDelete={() => deleteNote(note.id)}
                                                        onTogglePin={() => updateNote(note.id, { isPinned: !note.isPinned })}
                                                    />
                                                ))}
                                                <div 
                                                    className="add-card"
                                                    onClick={addNote}
                                                    style={{
                                                        border: '2px dashed #d1d5db',
                                                        borderRadius: '8px',
                                                        padding: '40px 20px',
                                                        display: 'flex',
                                                        alignItems: 'center',
                                                        justifyContent: 'center',
                                                        cursor: 'pointer',
                                                        backgroundColor: '#f9fafb',
                                                        transition: 'all 0.2s',
                                                        minHeight: '150px'
                                                    }}
                                                    onMouseEnter={(e) => {
                                                        e.currentTarget.style.borderColor = '#4f46e5';
                                                        e.currentTarget.style.backgroundColor = '#eff6ff';
                                                    }}
                                                    onMouseLeave={(e) => {
                                                        e.currentTarget.style.borderColor = '#d1d5db';
                                                        e.currentTarget.style.backgroundColor = '#f9fafb';
                                                    }}
                                                >
                                                    <span style={{ fontSize: '16px', color: '#6b7280', fontWeight: 500 }}>
                                                        + Add Note
                                                    </span>
                                                </div>
                                            </div>
                                        ) : (
                                            <NotesList
                                                notes={filteredNotes}
                                                onEdit={(id) => {
                                                    setEditingCard(id);
                                                    setShowModal(true);
                                                }}
                                                onDelete={deleteNote}
                                                onTogglePin={(id, isPinned) => updateNote(id, { isPinned })}
                                            />
                                        )}
                                    </>
                                )}
                            </main>
                        </>
                    )}

                    <footer className="footer">
                        <p>Created by Kevin Hwang with Claude</p>
                        <p>Last Modified: {lastModified}</p>
                    </footer>

                    {/* Edit Modals */}
                    {showModal && editingCard && (
                        <>
                            {activeMainTab === 'characters' && (
                                <CharacterEditModal
                                    character={characters.find(c => c.id === editingCard)}
                                    onSave={(updates) => {
                                        updateCharacter(editingCard, updates);
                                        setShowModal(false);
                                        setEditingCard(null);
                                    }}
                                    onCancel={() => {
                                        setShowModal(false);
                                        setEditingCard(null);
                                    }}
                                />
                            )}
                            {activeMainTab === 'locations' && (
                                <LocationEditModal
                                    location={locations.find(l => l.id === editingCard)}
                                    onSave={(updates) => {
                                        updateLocation(editingCard, updates);
                                        setShowModal(false);
                                        setEditingCard(null);
                                    }}
                                    onCancel={() => {
                                        setShowModal(false);
                                        setEditingCard(null);
                                    }}
                                />
                            )}
                            {activeMainTab === 'notes' && (
                                <NoteEditModal
                                    note={notes.find(n => n.id === editingCard)}
                                    onSave={(updates) => {
                                        updateNote(editingCard, updates);
                                        setShowModal(false);
                                        setEditingCard(null);
                                    }}
                                    onCancel={() => {
                                        setShowModal(false);
                                        setEditingCard(null);
                                    }}
                                />
                            )}
                        </>
                    )}

                    {/* Scene Edit Modal */}
                    {showSceneModal && editingScene && (
                        <SceneEditModal
                            scene={scenes.find(s => s.id === editingScene)}
                            onSave={(updates) => {
                                updateScene(editingScene, updates);
                                setShowSceneModal(false);
                                setEditingScene(null);
                            }}
                            onCancel={() => {
                                setShowSceneModal(false);
                                setEditingScene(null);
                            }}
                        />
                    )}
                </div>
            );
        }

        // Scene components
        function SceneCard({ scene, isEditing, isDragging, onEdit, onDone, onUpdate, onDelete, onDragStart, onDragOver, onDrop }) {
            
            const handleTypeChange = (newType) => {
                if (scene.type === newType) return; // Already this type
                
                // Check if other type has data
                const hasActionData = scene.objective || scene.obstacle || scene.outcome;
                const hasReactionData = scene.emotion || scene.deliberation || scene.decision;
                
                const willLoseData = (newType === 'action' && hasReactionData) || 
                                    (newType === 'reaction' && hasActionData);
                
                if (willLoseData) {
                    const confirmMsg = newType === 'action' 
                        ? 'Switch to Action scene? This will clear Reaction fields (Emotion, Deliberation, Decision).'
                        : 'Switch to Reaction scene? This will clear Action fields (Objective, Obstacle, Outcome).';
                    
                    if (!confirm(confirmMsg)) {
                        return; // User cancelled
                    }
                }
                
                // Clear the other type's fields
                const updates = { type: newType };
                if (newType === 'action') {
                    updates.emotion = '';
                    updates.deliberation = '';
                    updates.decision = '';
                } else {
                    updates.objective = '';
                    updates.obstacle = '';
                    updates.outcome = '';
                }
                
                onUpdate(updates);
            };
            
            if (!isEditing) {
                return (
                    <div 
                        className={`scene-card ${scene.color} ${isDragging ? 'dragging' : ''}`} 
                        onClick={onEdit}
                        draggable
                        onDragStart={(e) => onDragStart(e, scene)}
                        onDragOver={onDragOver}
                        onDrop={(e) => onDrop(e, scene, scene.act, scene.chapterId)}
                    >
                        <div className="scene-header">
                            <div className="scene-title-section">
                                <div className="scene-title">
                                    {scene.title || 'Untitled Scene'}
                                </div>
                                <div className="scene-type">
                                    {scene.type === 'action' ? 'âš¡ Action' : 'ðŸ’­ Reaction'}
                                </div>
                            </div>
                        </div>
                        
                        {scene.type === 'action' ? (
                            <div className="scene-details">
                                {scene.objective && (
                                    <div className="scene-detail-row">
                                        <span className="scene-detail-label">Objective:</span>
                                        {scene.objective.substring(0, 40)}{scene.objective.length > 40 ? '...' : ''}
                                    </div>
                                )}
                                {scene.obstacle && (
                                    <div className="scene-detail-row">
                                        <span className="scene-detail-label">Obstacle:</span>
                                        {scene.obstacle.substring(0, 40)}{scene.obstacle.length > 40 ? '...' : ''}
                                    </div>
                                )}
                                {scene.outcome && (
                                    <div className="scene-detail-row">
                                        <span className="scene-detail-label">Outcome:</span>
                                        {scene.outcome.substring(0, 40)}{scene.outcome.length > 40 ? '...' : ''}
                                    </div>
                                )}
                            </div>
                        ) : (
                            <div className="scene-details">
                                {scene.emotion && (
                                    <div className="scene-detail-row">
                                        <span className="scene-detail-label">Emotion:</span>
                                        {scene.emotion.substring(0, 40)}{scene.emotion.length > 40 ? '...' : ''}
                                    </div>
                                )}
                                {scene.deliberation && (
                                    <div className="scene-detail-row">
                                        <span className="scene-detail-label">Deliberation:</span>
                                        {scene.deliberation.substring(0, 40)}{scene.deliberation.length > 40 ? '...' : ''}
                                    </div>
                                )}
                                {scene.decision && (
                                    <div className="scene-detail-row">
                                        <span className="scene-detail-label">Decision:</span>
                                        {scene.decision.substring(0, 40)}{scene.decision.length > 40 ? '...' : ''}
                                    </div>
                                )}
                            </div>
                        )}
                    </div>
                );
            }

            // Editing mode
            return (
                <div className={`scene-card editing ${scene.color}`} onClick={(e) => e.stopPropagation()}>
                    <div className="scene-header">
                        <input
                            type="text"
                            value={scene.title}
                            onChange={(e) => onUpdate({ title: e.target.value })}
                            placeholder="Scene title"
                            style={{ 
                                width: '100%', 
                                border: 'none', 
                                background: 'transparent',
                                fontSize: '15px',
                                fontWeight: 600,
                                padding: '4px',
                                marginBottom: '8px'
                            }}
                        />
                        <div className="scene-actions">
                            <button className="icon-btn delete" onClick={onDelete}>ðŸ—‘ï¸</button>
                            <button 
                                onClick={onDone}
                                style={{
                                    padding: '4px 12px',
                                    border: 'none',
                                    borderRadius: '4px',
                                    fontSize: '12px',
                                    cursor: 'pointer',
                                    background: '#4f46e5',
                                    color: 'white',
                                    fontWeight: 500
                                }}
                            >
                                Done
                            </button>
                        </div>
                    </div>

                    <div style={{ marginBottom: '12px', display: 'flex', gap: '8px' }}>
                        <button
                            onClick={() => handleTypeChange('action')}
                            style={{
                                flex: 1,
                                padding: '8px',
                                border: scene.type === 'action' ? '2px solid #4f46e5' : '1px solid #d1d5db',
                                borderRadius: '6px',
                                background: scene.type === 'action' ? '#eff6ff' : 'white',
                                cursor: 'pointer',
                                fontWeight: scene.type === 'action' ? 600 : 400,
                                color: scene.type === 'action' ? '#1e40af' : '#374151'
                            }}
                        >
                            âš¡ Action
                        </button>
                        <button
                            onClick={() => handleTypeChange('reaction')}
                            style={{
                                flex: 1,
                                padding: '8px',
                                border: scene.type === 'reaction' ? '2px solid #4f46e5' : '1px solid #d1d5db',
                                borderRadius: '6px',
                                background: scene.type === 'reaction' ? '#eff6ff' : 'white',
                                cursor: 'pointer',
                                fontWeight: scene.type === 'reaction' ? 600 : 400,
                                color: scene.type === 'reaction' ? '#1e40af' : '#374151'
                            }}
                        >
                            ðŸ’­ Reaction
                        </button>
                    </div>

                    {scene.type === 'action' ? (
                        <>
                            <textarea
                                value={scene.objective}
                                onChange={(e) => onUpdate({ objective: e.target.value })}
                                placeholder="Objective: What does the character want?"
                                style={{ width: '100%', minHeight: '50px', marginBottom: '6px', padding: '6px', fontSize: '13px' }}
                            />
                            <textarea
                                value={scene.obstacle}
                                onChange={(e) => onUpdate({ obstacle: e.target.value })}
                                placeholder="Obstacle: What stands in their way?"
                                style={{ width: '100%', minHeight: '50px', marginBottom: '6px', padding: '6px', fontSize: '13px' }}
                            />
                            <textarea
                                value={scene.outcome}
                                onChange={(e) => onUpdate({ outcome: e.target.value })}
                                placeholder="Outcome: What happens?"
                                style={{ width: '100%', minHeight: '50px', marginBottom: '6px', padding: '6px', fontSize: '13px' }}
                            />
                        </>
                    ) : (
                        <>
                            <textarea
                                value={scene.emotion}
                                onChange={(e) => onUpdate({ emotion: e.target.value })}
                                placeholder="Emotion: How do they feel?"
                                style={{ width: '100%', minHeight: '50px', marginBottom: '6px', padding: '6px', fontSize: '13px' }}
                            />
                            <textarea
                                value={scene.deliberation}
                                onChange={(e) => onUpdate({ deliberation: e.target.value })}
                                placeholder="Deliberation: What do they consider?"
                                style={{ width: '100%', minHeight: '50px', marginBottom: '6px', padding: '6px', fontSize: '13px' }}
                            />
                            <textarea
                                value={scene.decision}
                                onChange={(e) => onUpdate({ decision: e.target.value })}
                                placeholder="Decision: What do they decide?"
                                style={{ width: '100%', minHeight: '50px', marginBottom: '6px', padding: '6px', fontSize: '13px' }}
                            />
                        </>
                    )}

                    <textarea
                        value={scene.notes}
                        onChange={(e) => onUpdate({ notes: e.target.value })}
                        placeholder="Notes..."
                        style={{ width: '100%', minHeight: '40px', marginBottom: '12px', padding: '6px', fontSize: '13px' }}
                    />

                    <div style={{ 
                        display: 'flex', 
                        gap: '6px', 
                        flexWrap: 'wrap',
                        paddingTop: '8px',
                        borderTop: '1px solid #e5e7eb'
                    }}>
                        {COLORS.map(color => (
                            <button
                                key={color.className}
                                onClick={() => onUpdate({ color: color.className })}
                                className={color.className}
                                style={{
                                    width: '32px',
                                    height: '32px',
                                    border: scene.color === color.className ? '3px solid #4f46e5' : '2px solid',
                                    borderRadius: '6px',
                                    cursor: 'pointer'
                                }}
                                title={color.name}
                            />
                        ))}
                    </div>
                </div>
            );
        }

        // Scenes List component
        function ScenesList({ scenes, chapters, expandedRow, onToggleExpand, onEdit, onDelete, getChapterNumber }) {
            const truncate = (text, length) => {
                if (!text) return 'â€”';
                return text.length > length ? text.substring(0, length) + '...' : text;
            };

            if (scenes.length === 0) {
                return (
                    <div className="empty-state">
                        <h2 className="empty-title">No Scenes Found</h2>
                        <p className="empty-subtitle">No scenes match your search.</p>
                    </div>
                );
            }

            return (
                <div className="scenes-table-container">
                    <table className="scenes-table">
                        <thead>
                            <tr>
                                <th style={{ width: '40px' }}>Act</th>
                                <th style={{ width: '45px' }}>Ch#</th>
                                <th style={{ width: '180px' }}>Title</th>
                                <th style={{ width: '45px', textAlign: 'center' }}>Type</th>
                                <th style={{ width: '200px' }}>Field 1</th>
                                <th style={{ width: '200px' }}>Field 2</th>
                                <th style={{ width: '200px' }}>Field 3</th>
                                <th style={{ width: '40px', textAlign: 'center' }}>Color</th>
                                <th style={{ width: '100px' }}>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {scenes.map(scene => (
                                <React.Fragment key={scene.id}>
                                    <tr className={expandedRow === scene.id ? 'scene-row-expanded' : ''}>
                                        <td>{scene.act}</td>
                                        <td className="chapter-number">
                                            {getChapterNumber(scene.chapterId)}
                                        </td>
                                        <td 
                                            style={{ cursor: 'pointer', fontWeight: 500 }}
                                            onClick={() => onToggleExpand(scene.id)}
                                            title={scene.title}
                                        >
                                            {scene.title || <em style={{ color: '#9ca3af' }}>Untitled</em>}
                                        </td>
                                        <td style={{ textAlign: 'center', fontSize: '18px' }}>
                                            {scene.type === 'action' ? 'âš¡' : 'ðŸ’­'}
                                        </td>
                                        <td title={scene.type === 'action' ? scene.objective : scene.emotion}>
                                            {scene.type === 'action' 
                                                ? truncate(scene.objective, 40)
                                                : truncate(scene.emotion, 40)
                                            }
                                        </td>
                                        <td title={scene.type === 'action' ? scene.obstacle : scene.deliberation}>
                                            {scene.type === 'action' 
                                                ? truncate(scene.obstacle, 40)
                                                : truncate(scene.deliberation, 40)
                                            }
                                        </td>
                                        <td title={scene.type === 'action' ? scene.outcome : scene.decision}>
                                            {scene.type === 'action' 
                                                ? truncate(scene.outcome, 40)
                                                : truncate(scene.decision, 40)
                                            }
                                        </td>
                                        <td style={{ textAlign: 'center' }}>
                                            <div className={`color-dot ${scene.color}`}></div>
                                        </td>
                                        <td>
                                            <div style={{ display: 'flex', gap: '4px' }}>
                                                <button 
                                                    className="btn btn-small btn-gray"
                                                    onClick={() => onEdit(scene.id)}
                                                >
                                                    Edit
                                                </button>
                                                <button 
                                                    className="btn btn-small btn-danger"
                                                    onClick={() => onDelete(scene.id)}
                                                >
                                                    Del
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                    {expandedRow === scene.id && (
                                        <tr>
                                            <td colSpan="9">
                                                <div className="expanded-scene-content">
                                                    <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '16px', marginBottom: '12px' }}>
                                                        <div>
                                                            <div className="expanded-field-label">Full Title</div>
                                                            <div className="expanded-field-value">{scene.title || 'â€”'}</div>
                                                        </div>
                                                        <div>
                                                            <div className="expanded-field-label">Type</div>
                                                            <div className="expanded-field-value">
                                                                {scene.type === 'action' ? 'âš¡ Action' : 'ðŸ’­ Reaction'}
                                                            </div>
                                                        </div>
                                                    </div>

                                                    {scene.type === 'action' ? (
                                                        <>
                                                            {scene.objective && (
                                                                <div className="expanded-field">
                                                                    <div className="expanded-field-label">Objective</div>
                                                                    <div className="expanded-field-value">{scene.objective}</div>
                                                                </div>
                                                            )}
                                                            {scene.obstacle && (
                                                                <div className="expanded-field">
                                                                    <div className="expanded-field-label">Obstacle</div>
                                                                    <div className="expanded-field-value">{scene.obstacle}</div>
                                                                </div>
                                                            )}
                                                            {scene.outcome && (
                                                                <div className="expanded-field">
                                                                    <div className="expanded-field-label">Outcome</div>
                                                                    <div className="expanded-field-value">{scene.outcome}</div>
                                                                </div>
                                                            )}
                                                        </>
                                                    ) : (
                                                        <>
                                                            {scene.emotion && (
                                                                <div className="expanded-field">
                                                                    <div className="expanded-field-label">Emotion</div>
                                                                    <div className="expanded-field-value">{scene.emotion}</div>
                                                                </div>
                                                            )}
                                                            {scene.deliberation && (
                                                                <div className="expanded-field">
                                                                    <div className="expanded-field-label">Deliberation</div>
                                                                    <div className="expanded-field-value">{scene.deliberation}</div>
                                                                </div>
                                                            )}
                                                            {scene.decision && (
                                                                <div className="expanded-field">
                                                                    <div className="expanded-field-label">Decision</div>
                                                                    <div className="expanded-field-value">{scene.decision}</div>
                                                                </div>
                                                            )}
                                                        </>
                                                    )}

                                                    {scene.notes && (
                                                        <div className="expanded-field">
                                                            <div className="expanded-field-label">Notes</div>
                                                            <div className="expanded-field-value">{scene.notes}</div>
                                                        </div>
                                                    )}
                                                </div>
                                            </td>
                                        </tr>
                                    )}
                                </React.Fragment>
                            ))}
                        </tbody>
                    </table>
                </div>
            );
        }

        // Character components
        function CharacterCard({ character, isExpanded, isDragging, onToggleExpand, onEdit, onDelete, onDragStart, onDragOver, onDrop }) {
            const typeInfo = CHARACTER_TYPES.find(t => t.value === character.type) || CHARACTER_TYPES[2];
            
            return (
                <div 
                    className={`character-card ${isExpanded ? 'expanded' : ''} ${isDragging ? 'dragging' : ''}`}
                    draggable
                    onDragStart={(e) => onDragStart(e, character)}
                    onDragOver={onDragOver}
                    onDrop={(e) => onDrop(e, character)}
                >
                    <div className="card-header">
                        <div className="card-title-section">
                            <h3 className="card-name">{character.name || 'Unnamed Character'}</h3>
                            <div style={{ display: 'flex', gap: '6px', flexWrap: 'wrap', marginTop: '4px' }}>
                                <span className={`role-badge ${typeInfo.className}`}>
                                    {typeInfo.label}
                                </span>
                                {character.role && (
                                    <span className="role-badge" style={{ backgroundColor: '#f3f4f6', color: '#374151' }}>
                                        {character.role}
                                    </span>
                                )}
                            </div>
                        </div>
                        <div className="card-actions">
                            <button className="icon-btn" onClick={onEdit} title="Edit">
                                âœï¸
                            </button>
                            <button className="icon-btn delete" onClick={onDelete} title="Delete">
                                ðŸ—‘ï¸
                            </button>
                        </div>
                    </div>

                    {character.description && (
                        <div className="card-preview">
                            <div className="preview-text">{character.description}</div>
                        </div>
                    )}

                    {!isExpanded && (
                        <button 
                            className="btn btn-gray btn-small" 
                            onClick={onToggleExpand}
                            style={{ marginTop: '12px', width: '100%' }}
                        >
                            Show Details
                        </button>
                    )}

                    {isExpanded && (
                        <>
                            <div className="card-details">
                                {character.personality && (
                                    <div className="detail-section">
                                        <div className="detail-label">Personality</div>
                                        <div className="detail-content">{character.personality}</div>
                                    </div>
                                )}

                                {character.backstory && (
                                    <div className="detail-section">
                                        <div className="detail-label">Backstory</div>
                                        <div className="detail-content">{character.backstory}</div>
                                    </div>
                                )}

                                {character.arc && (
                                    <div className="detail-section">
                                        <div className="detail-label">Character Arc</div>
                                        <div className="detail-content">{character.arc}</div>
                                    </div>
                                )}

                                {character.relationships && (
                                    <div className="detail-section">
                                        <div className="detail-label">Relationships</div>
                                        <div className="detail-content">{character.relationships}</div>
                                    </div>
                                )}

                                {character.firstAppearance && (
                                    <div className="detail-section">
                                        <div className="detail-label">First Appearance</div>
                                        <div className="detail-content">{character.firstAppearance}</div>
                                    </div>
                                )}

                                {character.notes && (
                                    <div className="detail-section">
                                        <div className="detail-label">Notes</div>
                                        <div className="detail-content">{character.notes}</div>
                                    </div>
                                )}
                            </div>

                            <button 
                                className="btn btn-gray btn-small" 
                                onClick={onToggleExpand}
                                style={{ marginTop: '12px', width: '100%' }}
                            >
                                Hide Details
                            </button>
                        </>
                    )}
                </div>
            );
        }

        function CharacterList({ characters, draggedCharacter, onEdit, onDelete, onDragStart, onDragOver, onDrop }) {
            return (
                <div className="list-view">
                    <div className="list-header" style={{ gridTemplateColumns: '2fr 1fr 1fr 2fr 100px' }}>
                        <div>Name</div>
                        <div>Type</div>
                        <div>Role</div>
                        <div>Description</div>
                        <div>Actions</div>
                    </div>
                    {characters.map(character => {
                        const typeInfo = CHARACTER_TYPES.find(t => t.value === character.type) || CHARACTER_TYPES[2];
                        const isDragging = draggedCharacter?.id === character.id;
                        return (
                            <div 
                                key={character.id} 
                                className={`list-row ${isDragging ? 'dragging-row' : ''}`}
                                draggable
                                onDragStart={(e) => onDragStart(e, character)}
                                onDragOver={onDragOver}
                                onDrop={(e) => onDrop(e, character)}
                                style={{ gridTemplateColumns: '2fr 1fr 1fr 2fr 100px' }}
                            >
                                <div className="list-cell">
                                    <strong>{character.name || 'Unnamed'}</strong>
                                </div>
                                <div className="list-cell">
                                    <span className={`role-badge ${typeInfo.className}`}>
                                        {typeInfo.label}
                                    </span>
                                </div>
                                <div className="list-cell">
                                    {character.role || 'â€”'}
                                </div>
                                <div className="list-cell">
                                    {character.description || 'â€”'}
                                </div>
                                <div className="list-cell list-actions">
                                    <button className="btn btn-small btn-gray" onClick={() => onEdit(character.id)}>
                                        Edit
                                    </button>
                                    <button className="btn btn-small btn-danger" onClick={() => onDelete(character.id)}>
                                        Delete
                                    </button>
                                </div>
                            </div>
                        );
                    })}
                </div>
            );
        }

        // Note components
        function NoteCard({ note, isExpanded, onToggleExpand, onEdit, onDelete, onTogglePin }) {
            const truncate = (text, length) => {
                if (!text) return '';
                return text.length > length ? text.substring(0, length) + '...' : text;
            };

            return (
                <div className={`card ${note.color}`}>
                    <div className="card-header">
                        <div style={{ display: 'flex', alignItems: 'flex-start', gap: '8px', flex: 1 }}>
                            {note.isPinned && (
                                <span style={{ fontSize: '16px', cursor: 'pointer' }} onClick={onTogglePin} title="Unpin">
                                    ðŸ“Œ
                                </span>
                            )}
                            <div style={{ flex: 1 }}>
                                <div className="card-title">
                                    {note.title || <em style={{ color: '#9ca3af' }}>Untitled Note</em>}
                                </div>
                            </div>
                        </div>
                        <div className="card-actions">
                            <button className="icon-btn" onClick={onToggleExpand} title={isExpanded ? "Collapse" : "Expand"}>
                                {isExpanded ? 'â–²' : 'â–¼'}
                            </button>
                            <button className="icon-btn edit" onClick={onEdit} title="Edit">âœï¸</button>
                            <button className="icon-btn delete" onClick={onDelete} title="Delete">ðŸ—‘ï¸</button>
                        </div>
                    </div>
                    
                    <div className="card-content">
                        <p style={{ color: '#6b7280', fontSize: '14px', lineHeight: '1.6', whiteSpace: isExpanded ? 'pre-wrap' : 'normal' }}>
                            {isExpanded ? (note.content || 'No content') : truncate(note.content, 100)}
                        </p>
                    </div>
                </div>
            );
        }

        function NotesList({ notes, onEdit, onDelete, onTogglePin }) {
            const truncate = (text, length) => {
                if (!text) return 'â€”';
                return text.length > length ? text.substring(0, length) + '...' : text;
            };

            if (notes.length === 0) {
                return (
                    <div className="empty-state">
                        <h2 className="empty-title">No Notes Found</h2>
                        <p className="empty-subtitle">No notes match your search.</p>
                    </div>
                );
            }

            return (
                <div className="list-container">
                    <table className="list-table">
                        <thead>
                            <tr>
                                <th style={{ width: '40px' }}></th>
                                <th style={{ width: '250px' }}>Title</th>
                                <th>Content</th>
                                <th style={{ width: '40px' }}>Color</th>
                                <th style={{ width: '120px' }}>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {notes.map(note => (
                                <tr key={note.id}>
                                    <td style={{ textAlign: 'center', fontSize: '16px', cursor: 'pointer' }} onClick={() => onTogglePin(note.id, !note.isPinned)}>
                                        {note.isPinned ? 'ðŸ“Œ' : ''}
                                    </td>
                                    <td style={{ fontWeight: 500 }}>
                                        {note.title || <em style={{ color: '#9ca3af' }}>Untitled</em>}
                                    </td>
                                    <td title={note.content}>
                                        {truncate(note.content, 80)}
                                    </td>
                                    <td style={{ textAlign: 'center' }}>
                                        <div className={`color-dot ${note.color}`}></div>
                                    </td>
                                    <td>
                                        <div style={{ display: 'flex', gap: '4px' }}>
                                            <button 
                                                className="btn btn-small btn-gray"
                                                onClick={() => onEdit(note.id)}
                                            >
                                                Edit
                                            </button>
                                            <button 
                                                className="btn btn-small btn-danger"
                                                onClick={() => onDelete(note.id)}
                                            >
                                                Del
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            ))}
                        </tbody>
                    </table>
                </div>
            );
        }

        function CharacterEditModal({ character, onSave, onCancel }) {
            const [formData, setFormData] = useState({ ...character });

            const handleChange = (field, value) => {
                setFormData({ ...formData, [field]: value });
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave(formData);
            };

            return (
                <div className="modal-overlay" onClick={onCancel}>
                    <div className="modal" onClick={(e) => e.stopPropagation()}>
                        <div className="modal-header">
                            <h2 className="modal-title">
                                {character.name ? `Edit ${character.name}` : 'New Character'}
                            </h2>
                            <button className="close-btn" onClick={onCancel}>Ã—</button>
                        </div>

                        <form onSubmit={handleSubmit}>
                            <div className="form-group">
                                <label className="form-label">Name *</label>
                                <input
                                    type="text"
                                    value={formData.name}
                                    onChange={(e) => handleChange('name', e.target.value)}
                                    placeholder="Character name"
                                    required
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Type</label>
                                <select
                                    value={formData.type}
                                    onChange={(e) => handleChange('type', e.target.value)}
                                >
                                    {CHARACTER_TYPES.map(type => (
                                        <option key={type.value} value={type.value}>
                                            {type.label}
                                        </option>
                                    ))}
                                </select>
                            </div>

                            <div className="form-group">
                                <label className="form-label">Role</label>
                                <input
                                    type="text"
                                    value={formData.role}
                                    onChange={(e) => handleChange('role', e.target.value)}
                                    placeholder="e.g., love interest, mentor, manager..."
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Physical Description</label>
                                <textarea
                                    value={formData.description}
                                    onChange={(e) => handleChange('description', e.target.value)}
                                    placeholder="Describe their appearance..."
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Personality</label>
                                <textarea
                                    value={formData.personality}
                                    onChange={(e) => handleChange('personality', e.target.value)}
                                    placeholder="Describe their personality traits..."
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Backstory</label>
                                <textarea
                                    value={formData.backstory}
                                    onChange={(e) => handleChange('backstory', e.target.value)}
                                    placeholder="What's their history?"
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Character Arc</label>
                                <textarea
                                    value={formData.arc}
                                    onChange={(e) => handleChange('arc', e.target.value)}
                                    placeholder="How do they change throughout the story?"
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Relationships</label>
                                <textarea
                                    value={formData.relationships}
                                    onChange={(e) => handleChange('relationships', e.target.value)}
                                    placeholder="Connections to other characters..."
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">First Appearance</label>
                                <input
                                    type="text"
                                    value={formData.firstAppearance}
                                    onChange={(e) => handleChange('firstAppearance', e.target.value)}
                                    placeholder="e.g., Chapter 1, Scene 3"
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Notes</label>
                                <textarea
                                    value={formData.notes}
                                    onChange={(e) => handleChange('notes', e.target.value)}
                                    placeholder="Additional notes..."
                                />
                            </div>

                            <div className="modal-buttons">
                                <button type="button" className="btn btn-gray" onClick={onCancel}>
                                    Cancel
                                </button>
                                <button type="submit" className="btn btn-primary">
                                    Save Character
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        // Location components
        function LocationCard({ location, isExpanded, isDragging, onToggleExpand, onEdit, onDelete, onDragStart, onDragOver, onDrop }) {
            const typeInfo = LOCATION_TYPES.find(t => t.value === location.type) || LOCATION_TYPES[0];
            
            return (
                <div 
                    className={`character-card ${isExpanded ? 'expanded' : ''} ${isDragging ? 'dragging' : ''}`}
                    draggable
                    onDragStart={(e) => onDragStart(e, location)}
                    onDragOver={onDragOver}
                    onDrop={(e) => onDrop(e, location)}
                >
                    <div className="card-header">
                        <div className="card-title-section">
                            <h3 className="card-name">{location.name || 'Unnamed Location'}</h3>
                            <div style={{ display: 'flex', gap: '6px', flexWrap: 'wrap', marginTop: '4px' }}>
                                <span className="role-badge" style={{ backgroundColor: '#dbeafe', color: '#1e40af' }}>
                                    {typeInfo.label}
                                </span>
                            </div>
                        </div>
                        <div className="card-actions">
                            <button className="icon-btn" onClick={onEdit} title="Edit">
                                âœï¸
                            </button>
                            <button className="icon-btn delete" onClick={onDelete} title="Delete">
                                ðŸ—‘ï¸
                            </button>
                        </div>
                    </div>

                    {location.description && (
                        <div className="card-preview">
                            <div className="preview-text">{location.description}</div>
                        </div>
                    )}

                    {!isExpanded && (
                        <button 
                            className="btn btn-gray btn-small" 
                            onClick={onToggleExpand}
                            style={{ marginTop: '12px', width: '100%' }}
                        >
                            Show Details
                        </button>
                    )}

                    {isExpanded && (
                        <>
                            <div className="card-details">
                                {location.significance && (
                                    <div className="detail-section">
                                        <div className="detail-label">Significance</div>
                                        <div className="detail-content">{location.significance}</div>
                                    </div>
                                )}

                                {location.associatedCharacters && (
                                    <div className="detail-section">
                                        <div className="detail-label">Associated Characters</div>
                                        <div className="detail-content">{location.associatedCharacters}</div>
                                    </div>
                                )}

                                {location.notes && (
                                    <div className="detail-section">
                                        <div className="detail-label">Notes</div>
                                        <div className="detail-content">{location.notes}</div>
                                    </div>
                                )}
                            </div>

                            <button 
                                className="btn btn-gray btn-small" 
                                onClick={onToggleExpand}
                                style={{ marginTop: '12px', width: '100%' }}
                            >
                                Hide Details
                            </button>
                        </>
                    )}
                </div>
            );
        }

        function LocationList({ locations, draggedLocation, onEdit, onDelete, onDragStart, onDragOver, onDrop }) {
            return (
                <div className="list-view">
                    <div className="list-header" style={{ gridTemplateColumns: '2fr 1fr 2fr 2fr 100px' }}>
                        <div>Name</div>
                        <div>Type</div>
                        <div>Description</div>
                        <div>Associated Characters</div>
                        <div>Actions</div>
                    </div>
                    {locations.map(location => {
                        const typeInfo = LOCATION_TYPES.find(t => t.value === location.type) || LOCATION_TYPES[0];
                        const isDragging = draggedLocation?.id === location.id;
                        return (
                            <div 
                                key={location.id} 
                                className={`list-row ${isDragging ? 'dragging-row' : ''}`}
                                draggable
                                onDragStart={(e) => onDragStart(e, location)}
                                onDragOver={onDragOver}
                                onDrop={(e) => onDrop(e, location)}
                                style={{ gridTemplateColumns: '2fr 1fr 2fr 2fr 100px' }}
                            >
                                <div className="list-cell">
                                    <strong>{location.name || 'Unnamed'}</strong>
                                </div>
                                <div className="list-cell">
                                    <span className="role-badge" style={{ backgroundColor: '#dbeafe', color: '#1e40af' }}>
                                        {typeInfo.label}
                                    </span>
                                </div>
                                <div className="list-cell">
                                    {location.description || 'â€”'}
                                </div>
                                <div className="list-cell">
                                    {location.associatedCharacters || 'â€”'}
                                </div>
                                <div className="list-cell list-actions">
                                    <button className="btn btn-small btn-gray" onClick={() => onEdit(location.id)}>
                                        Edit
                                    </button>
                                    <button className="btn btn-small btn-danger" onClick={() => onDelete(location.id)}>
                                        Delete
                                    </button>
                                </div>
                            </div>
                        );
                    })}
                </div>
            );
        }

        function LocationEditModal({ location, onSave, onCancel }) {
            const [formData, setFormData] = useState({ ...location });

            const handleChange = (field, value) => {
                setFormData({ ...formData, [field]: value });
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave(formData);
            };

            return (
                <div className="modal-overlay" onClick={onCancel}>
                    <div className="modal" onClick={(e) => e.stopPropagation()}>
                        <div className="modal-header">
                            <h2 className="modal-title">
                                {location.name ? `Edit ${location.name}` : 'New Location'}
                            </h2>
                            <button className="close-btn" onClick={onCancel}>Ã—</button>
                        </div>

                        <form onSubmit={handleSubmit}>
                            <div className="form-group">
                                <label className="form-label">Location Name *</label>
                                <input
                                    type="text"
                                    value={formData.name}
                                    onChange={(e) => handleChange('name', e.target.value)}
                                    placeholder="Location name"
                                    required
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Type</label>
                                <select
                                    value={formData.type}
                                    onChange={(e) => handleChange('type', e.target.value)}
                                >
                                    {LOCATION_TYPES.map(type => (
                                        <option key={type.value} value={type.value}>
                                            {type.label}
                                        </option>
                                    ))}
                                </select>
                            </div>

                            <div className="form-group">
                                <label className="form-label">Description (Sensory Details & Atmosphere)</label>
                                <textarea
                                    value={formData.description}
                                    onChange={(e) => handleChange('description', e.target.value)}
                                    placeholder="What does this place look, sound, smell, and feel like?"
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Significance to Story</label>
                                <textarea
                                    value={formData.significance}
                                    onChange={(e) => handleChange('significance', e.target.value)}
                                    placeholder="Why is this location important? What happens here?"
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Associated Characters</label>
                                <input
                                    type="text"
                                    value={formData.associatedCharacters}
                                    onChange={(e) => handleChange('associatedCharacters', e.target.value)}
                                    placeholder="Which characters appear here?"
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Notes</label>
                                <textarea
                                    value={formData.notes}
                                    onChange={(e) => handleChange('notes', e.target.value)}
                                    placeholder="Additional notes..."
                                />
                            </div>

                            <div className="modal-buttons">
                                <button type="button" className="btn btn-gray" onClick={onCancel}>
                                    Cancel
                                </button>
                                <button type="submit" className="btn btn-primary">
                                    Save Location
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        function SceneEditModal({ scene, onSave, onCancel }) {
            const [formData, setFormData] = useState({ ...scene });

            const handleChange = (field, value) => {
                setFormData({ ...formData, [field]: value });
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave(formData);
            };

            return (
                <div className="modal-overlay" onClick={onCancel}>
                    <div className="modal" onClick={(e) => e.stopPropagation()}>
                        <div className="modal-header">
                            <h2 className="modal-title">
                                {scene.title ? `Edit ${scene.title}` : 'Edit Scene'}
                            </h2>
                            <button className="close-btn" onClick={onCancel}>Ã—</button>
                        </div>

                        <form onSubmit={handleSubmit}>
                            <div className="form-group">
                                <label className="form-label">Title *</label>
                                <input
                                    type="text"
                                    value={formData.title}
                                    onChange={(e) => handleChange('title', e.target.value)}
                                    placeholder="Scene title"
                                    required
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Type</label>
                                <div style={{ display: 'flex', gap: '8px', marginTop: '8px' }}>
                                    <button
                                        type="button"
                                        onClick={() => handleChange('type', 'action')}
                                        style={{
                                            flex: 1,
                                            padding: '8px',
                                            border: formData.type === 'action' ? '2px solid #4f46e5' : '1px solid #d1d5db',
                                            borderRadius: '6px',
                                            background: formData.type === 'action' ? '#eff6ff' : 'white',
                                            cursor: 'pointer',
                                            fontWeight: formData.type === 'action' ? 600 : 400,
                                            color: formData.type === 'action' ? '#1e40af' : '#374151'
                                        }}
                                    >
                                        âš¡ Action
                                    </button>
                                    <button
                                        type="button"
                                        onClick={() => handleChange('type', 'reaction')}
                                        style={{
                                            flex: 1,
                                            padding: '8px',
                                            border: formData.type === 'reaction' ? '2px solid #4f46e5' : '1px solid #d1d5db',
                                            borderRadius: '6px',
                                            background: formData.type === 'reaction' ? '#eff6ff' : 'white',
                                            cursor: 'pointer',
                                            fontWeight: formData.type === 'reaction' ? 600 : 400,
                                            color: formData.type === 'reaction' ? '#1e40af' : '#374151'
                                        }}
                                    >
                                        ðŸ’­ Reaction
                                    </button>
                                </div>
                            </div>

                            {formData.type === 'action' ? (
                                <>
                                    <div className="form-group">
                                        <label className="form-label">Objective</label>
                                        <textarea
                                            value={formData.objective}
                                            onChange={(e) => handleChange('objective', e.target.value)}
                                            placeholder="What does the character want?"
                                        />
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Obstacle</label>
                                        <textarea
                                            value={formData.obstacle}
                                            onChange={(e) => handleChange('obstacle', e.target.value)}
                                            placeholder="What stands in their way?"
                                        />
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Outcome</label>
                                        <textarea
                                            value={formData.outcome}
                                            onChange={(e) => handleChange('outcome', e.target.value)}
                                            placeholder="What happens?"
                                        />
                                    </div>
                                </>
                            ) : (
                                <>
                                    <div className="form-group">
                                        <label className="form-label">Emotion</label>
                                        <textarea
                                            value={formData.emotion}
                                            onChange={(e) => handleChange('emotion', e.target.value)}
                                            placeholder="How do they feel?"
                                        />
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Deliberation</label>
                                        <textarea
                                            value={formData.deliberation}
                                            onChange={(e) => handleChange('deliberation', e.target.value)}
                                            placeholder="What do they consider?"
                                        />
                                    </div>

                                    <div className="form-group">
                                        <label className="form-label">Decision</label>
                                        <textarea
                                            value={formData.decision}
                                            onChange={(e) => handleChange('decision', e.target.value)}
                                            placeholder="What do they decide?"
                                        />
                                    </div>
                                </>
                            )}

                            <div className="form-group">
                                <label className="form-label">Notes</label>
                                <textarea
                                    value={formData.notes}
                                    onChange={(e) => handleChange('notes', e.target.value)}
                                    placeholder="Additional notes..."
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Color</label>
                                <div style={{ 
                                    display: 'flex', 
                                    gap: '6px', 
                                    flexWrap: 'wrap',
                                    marginTop: '8px'
                                }}>
                                    {COLORS.map(color => (
                                        <button
                                            key={color.className}
                                            type="button"
                                            onClick={() => handleChange('color', color.className)}
                                            className={color.className}
                                            style={{
                                                width: '32px',
                                                height: '32px',
                                                border: formData.color === color.className ? '3px solid #4f46e5' : '2px solid',
                                                borderRadius: '6px',
                                                cursor: 'pointer'
                                            }}
                                            title={color.name}
                                        />
                                    ))}
                                </div>
                            </div>

                            <div className="modal-buttons">
                                <button type="button" className="btn btn-gray" onClick={onCancel}>
                                    Cancel
                                </button>
                                <button type="submit" className="btn btn-primary">
                                    Save Scene
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        function NoteEditModal({ note, onSave, onCancel }) {
            const [formData, setFormData] = useState({ ...note });

            const handleChange = (field, value) => {
                setFormData({ ...formData, [field]: value });
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                onSave(formData);
            };

            return (
                <div className="modal-overlay" onClick={onCancel}>
                    <div className="modal" onClick={(e) => e.stopPropagation()}>
                        <div className="modal-header">
                            <h2 className="modal-title">
                                {note.title ? `Edit ${note.title}` : 'Edit Note'}
                            </h2>
                            <button className="close-btn" onClick={onCancel}>Ã—</button>
                        </div>

                        <form onSubmit={handleSubmit}>
                            <div className="form-group">
                                <label className="form-label">Title *</label>
                                <input
                                    type="text"
                                    value={formData.title}
                                    onChange={(e) => handleChange('title', e.target.value)}
                                    placeholder="Note title"
                                    required
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Content</label>
                                <textarea
                                    value={formData.content}
                                    onChange={(e) => handleChange('content', e.target.value)}
                                    placeholder="Your notes here..."
                                    style={{ minHeight: '200px' }}
                                />
                            </div>

                            <div className="form-group">
                                <label className="form-label">Color</label>
                                <div style={{ 
                                    display: 'flex', 
                                    gap: '6px', 
                                    flexWrap: 'wrap',
                                    marginTop: '8px'
                                }}>
                                    {COLORS.map(color => (
                                        <button
                                            key={color.className}
                                            type="button"
                                            onClick={() => handleChange('color', color.className)}
                                            className={color.className}
                                            style={{
                                                width: '32px',
                                                height: '32px',
                                                border: formData.color === color.className ? '3px solid #4f46e5' : '2px solid',
                                                borderRadius: '6px',
                                                cursor: 'pointer'
                                            }}
                                            title={color.name}
                                        />
                                    ))}
                                </div>
                            </div>

                            <div className="form-group">
                                <label style={{ display: 'flex', alignItems: 'center', gap: '8px', cursor: 'pointer' }}>
                                    <input
                                        type="checkbox"
                                        checked={formData.isPinned}
                                        onChange={(e) => handleChange('isPinned', e.target.checked)}
                                    />
                                    <span>ðŸ“Œ Pin to top</span>
                                </label>
                            </div>

                            <div className="modal-buttons">
                                <button type="button" className="btn btn-gray" onClick={onCancel}>
                                    Cancel
                                </button>
                                <button type="submit" className="btn btn-primary">
                                    Save Note
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>